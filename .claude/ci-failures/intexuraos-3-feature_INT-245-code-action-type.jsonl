{"ts":"2026-01-24T22:43:21.416Z","project":"intexuraos-3","branch":"feature/INT-245-code-action-type","runNumber":1,"passed":false,"durationMs":55616,"failureCount":12,"failures":[{"type":"typecheck","code":"TS6196","file":"apps/actions-agent/src/__tests__/executeCodeAction.test.ts","line":4,"message":"'CodeActionPayload' is declared but never used.","snippet":"import type { Action, CodeActionPayload } from '../domain/models/action.js';","context":" 2: import { isOk, isErr } from '@intexuraos/common-core';\n 3: import { createExecuteCodeActionUseCase } from '../domain/usecases/executeCodeAction.js';\n>4: import type { Action, CodeActionPayload } from '../domain/models/action.js';\n 5: import {\n 6:   FakeActionRepository,"},{"type":"typecheck","code":"TS6133","file":"apps/actions-agent/src/__tests__/fakes.ts","line":934,"message":"'actionId' is declared but its value is never read.","snippet":"return async (actionId: string): Promise<Result<ExecuteCodeActionResult, Error>> => {","context":" 932:   returnResult?: ExecuteCodeActionResult;\n 933: }): FakeExecuteCodeActionUseCase {\n>934:   return async (actionId: string): Promise<Result<ExecuteCodeActionResult, Error>> => {\n 935:     if (config?.failWithError !== undefined) {\n 936:       return err(config.failWithError);"},{"type":"typecheck","code":"TS2739","file":"apps/actions-agent/src/__tests__/fakes.ts","line":1255,"message":"Type '{ actionServiceClient: FakeActionServiceClient; researchServiceClient: FakeResearchServiceClient; notificationSender: FakeNotificationSender; ... 33 more ...; linear: HandleLinearActionUseCase; }' is missing the following properties from type 'Services': codeAgentClient, handleCodeActionUseCase, executeCodeActionUseCase, code","snippet":"return {","context":" 1253:     });\n 1254: \n>1255:   return {\n 1256:     actionServiceClient: deps.actionServiceClient,\n 1257:     researchServiceClient: deps.researchServiceClient,"},{"type":"typecheck","code":"TS6133","file":"apps/actions-agent/src/__tests__/handleCodeAction.test.ts","line":2,"message":"'isErr' is declared but its value is never read.","snippet":"import { isOk, isErr } from '@intexuraos/common-core';","context":" 1: import { describe, it, expect, beforeEach, vi } from 'vitest';\n>2: import { isOk, isErr } from '@intexuraos/common-core';\n 3: import { createHandleCodeActionUseCase } from '../domain/usecases/handleCodeAction.js';\n 4: import { registerActionHandler } from '../domain/usecases/createIdempotentActionHandler.js';"},{"type":"typecheck","code":"TS2322","file":"apps/actions-agent/src/__tests__/handleCodeAction.test.ts","line":61,"message":"Type 'string' is not assignable to type '\"pending\"'.","snippet":"status: 'pending' as const,","context":" 59:     confidence: 0.95,\n 60:     title: 'Fix authentication bug',\n>61:     status: 'pending' as const,\n 62:     payload: { prompt: 'Fix the login bug', confidence: 0.95, ...overrides.payload },\n 63:     createdAt: '2025-01-01T12:00:00.000Z',"},{"type":"typecheck","code":"TS2375","file":"apps/actions-agent/src/domain/usecases/executeCodeAction.ts","line":108,"message":"Type '{ prompt: string; workerType: \"opus\" | \"auto\" | \"glm\"; linearIssueId: string | undefined; linearIssueTitle: string | undefined; }' is not assignable to type 'CodeActionPayload' with 'exactOptionalPropertyTypes: true'. Consider adding 'undefined' to the types of the target's properties.","snippet":"payload: {","context":" 106:       actionId,\n 107:       approvalEventId,\n>108:       payload: {\n 109:         prompt,\n 110:         workerType,"},{"type":"typecheck","code":"TS2552","file":"apps/actions-agent/src/domain/usecases/handleApprovalReply.ts","line":383,"message":"Cannot find name 'executeCodeAction'. Did you mean 'executeAction'?","snippet":"if (executeCodeAction !== undefined) {","context":" 381:               break;\n 382:             case 'code':\n>383:               if (executeCodeAction !== undefined) {\n 384:                 logger.info({ actionId: action.id }, 'Executing code action directly after approval');\n 385:                 const result = await executeCodeAction(action.id);"},{"type":"typecheck","code":"TS2552","file":"apps/actions-agent/src/domain/usecases/handleApprovalReply.ts","line":385,"message":"Cannot find name 'executeCodeAction'. Did you mean 'executeAction'?","snippet":"const result = await executeCodeAction(action.id);","context":" 383:               if (executeCodeAction !== undefined) {\n 384:                 logger.info({ actionId: action.id }, 'Executing code action directly after approval');\n>385:                 const result = await executeCodeAction(action.id);\n 386:                 if (!result.ok) {\n 387:                   logger.error("},{"type":"typecheck","code":"TS2304","file":"apps/actions-agent/src/infra/http/codeAgentHttpClient.ts","line":45,"message":"Cannot find name 'CodeAgentError'.","snippet":"}): Promise<Result<{ codeTaskId: string; resourceUrl: string }, CodeAgentError>> {","context":" 43:       approvalEventId: string;\n 44:       payload: CodeActionPayload;\n>45:     }): Promise<Result<{ codeTaskId: string; resourceUrl: string }, CodeAgentError>> {\n 46:       const url = `${config.baseUrl}/internal/code/process`;\n 47:       const timeoutMs = 60_000; // 60 second timeout"},{"type":"typecheck","code":"TS2353","file":"apps/actions-agent/src/services.ts","line":419,"message":"Object literal may only specify known properties, and 'code' does not exist in type 'ActionHandlerRegistry'.","snippet":"code: handleCodeActionUseCase,","context":" 417:       calendar: handleCalendarActionUseCase,\n 418:       linear: handleLinearActionUseCase,\n>419:       code: handleCodeActionUseCase,\n 420:     },\n 421:     logger: pino({ name: 'retryPendingActions' }),"},{"type":"typecheck","code":"TS2322","file":"apps/commands-agent/src/infra/llm/classifier.ts","line":18,"message":"Type '\"code\"' is not assignable to type 'CommandType'.","snippet":"'code',","context":" 16:   'reminder',\n 17:   'linear',\n>18:   'code',\n 19: ] as const;\n 20: "},{"type":"verify","code":"VERIFY_FAIL","file":"unknown","line":0,"message":"FAILED","snippet":null,"context":null}]}
{"ts":"2026-01-24T22:48:52.724Z","project":"intexuraos-3","branch":"feature/INT-245-code-action-type","runNumber":2,"passed":false,"durationMs":54079,"failureCount":19,"failures":[{"type":"typecheck","code":"TS6133","file":"apps/actions-agent/src/__tests__/fakes.ts","line":934,"message":"'actionId' is declared but its value is never read.","snippet":"return async (actionId: string): Promise<Result<ExecuteCodeActionResult, Error>> => {","context":" 932:   returnResult?: ExecuteCodeActionResult;\n 933: }): FakeExecuteCodeActionUseCase {\n>934:   return async (actionId: string): Promise<Result<ExecuteCodeActionResult, Error>> => {\n 935:     if (config?.failWithError !== undefined) {\n 936:       return err(config.failWithError);"},{"type":"typecheck","code":"TS2345","file":"apps/actions-agent/src/__tests__/handleCodeAction.test.ts","line":74,"message":"Argument of type '{ id: \"action-123\"; userId: \"user-456\"; commandId: \"cmd-789\"; type: \"code\"; confidence: number; title: string; status: string; payload: Record<string, unknown>; createdAt: string; updatedAt: string; }' is not assignable to parameter of type 'Action'.","snippet":"await fakeActionRepository.save(createAction());","context":" 72: \n 73:   it('sets action to awaiting_approval and publishes WhatsApp notification', async () => {\n>74:     await fakeActionRepository.save(createAction());\n 75: \n 76:     const usecase = registerActionHandler(createHandleCodeActionUseCase, {"},{"type":"typecheck","code":"TS2345","file":"apps/actions-agent/src/__tests__/handleCodeAction.test.ts","line":108,"message":"Argument of type '{ id: \"action-123\"; userId: \"user-456\"; commandId: \"cmd-789\"; type: \"code\"; confidence: number; title: string; status: string; payload: Record<string, unknown>; createdAt: string; updatedAt: string; }' is not assignable to parameter of type 'Action'.","snippet":"await fakeActionRepository.save(action);","context":" 106:       payload: { prompt: longPrompt, confidence: 0.95 },\n 107:     });\n>108:     await fakeActionRepository.save(action);\n 109: \n 110:     const usecase = registerActionHandler(createHandleCodeActionUseCase, {"},{"type":"typecheck","code":"TS2345","file":"apps/actions-agent/src/__tests__/handleCodeAction.test.ts","line":130,"message":"Argument of type '{ id: \"action-123\"; userId: \"user-456\"; commandId: \"cmd-789\"; type: \"code\"; confidence: number; title: string; status: string; payload: Record<string, unknown>; createdAt: string; updatedAt: string; }' is not assignable to parameter of type 'Action'.","snippet":"await fakeActionRepository.save(createAction());","context":" 128: \n 129:   it('succeeds even when WhatsApp notification fails (best-effort)', async () => {\n>130:     await fakeActionRepository.save(createAction());\n 131:     fakeWhatsappPublisher.setFailNext(true, {\n 132:       code: 'PUBLISH_FAILED',"},{"type":"typecheck","code":"TS2345","file":"apps/actions-agent/src/__tests__/handleCodeAction.test.ts","line":159,"message":"Argument of type '{ id: \"action-123\"; userId: \"user-456\"; commandId: \"cmd-789\"; type: \"code\"; confidence: number; title: string; status: string; payload: Record<string, unknown>; createdAt: string; updatedAt: string; }' is not assignable to parameter of type 'Action'.","snippet":"await fakeActionRepository.save(createAction());","context":" 157:     mockShouldAutoExecute.mockReturnValue(true);\n 158: \n>159:     await fakeActionRepository.save(createAction());\n 160: \n 161:     const fakeExecuteCodeAction = createFakeExecuteCodeActionUseCaseWithRepo(fakeActionRepository);"},{"type":"typecheck","code":"TS2345","file":"apps/actions-agent/src/__tests__/handleCodeAction.test.ts","line":190,"message":"Argument of type '{ id: \"action-123\"; userId: \"user-456\"; commandId: \"cmd-789\"; type: \"code\"; confidence: number; title: string; status: string; payload: Record<string, unknown>; createdAt: string; updatedAt: string; }' is not assignable to parameter of type 'Action'.","snippet":"await fakeActionRepository.save(createAction());","context":" 188:     mockShouldAutoExecute.mockReturnValue(false);\n 189: \n>190:     await fakeActionRepository.save(createAction());\n 191: \n 192:     const fakeExecuteCodeAction = createFakeExecuteCodeActionUseCaseWithRepo(fakeActionRepository);"},{"type":"typecheck","code":"TS2345","file":"apps/actions-agent/src/__tests__/handleCodeAction.test.ts","line":215,"message":"Argument of type '{ id: \"action-123\"; userId: \"user-456\"; commandId: \"cmd-789\"; type: \"code\"; confidence: number; title: string; status: string; payload: Record<string, unknown>; createdAt: string; updatedAt: string; }' is not assignable to parameter of type 'Action'.","snippet":"await fakeActionRepository.save(action);","context":" 213:     it('returns success without sending notification when action already processed (idempotency)', async () => {\n 214:       const action = createAction({ status: 'awaiting_approval' });\n>215:       await fakeActionRepository.save(action);\n 216: \n 217:       const usecase = registerActionHandler(createHandleCodeActionUseCase, {"},{"type":"typecheck","code":"TS2741","file":"apps/actions-agent/src/__tests__/retryPendingActions.test.ts","line":69,"message":"Property 'code' is missing in type '{ research: HandleResearchActionUseCase; todo: HandleTodoActionUseCase; note: HandleNoteActionUseCase; link: HandleLinkActionUseCase; calendar: HandleCalendarActionUseCase; linear: HandleLinearActionUseCase; }' but required in type 'ActionHandlerRegistry'.","snippet":"actionHandlerRegistry: fakeHandlers,","context":" 67:       actionRepository: fakeActionRepository,\n 68:       actionEventPublisher: fakeActionEventPublisher,\n>69:       actionHandlerRegistry: fakeHandlers,\n 70:       logger: silentLogger,\n 71:     });"},{"type":"typecheck","code":"TS2741","file":"apps/actions-agent/src/__tests__/retryPendingActions.test.ts","line":90,"message":"Property 'code' is missing in type '{ research: HandleResearchActionUseCase; todo: HandleTodoActionUseCase; note: HandleNoteActionUseCase; link: HandleLinkActionUseCase; calendar: HandleCalendarActionUseCase; linear: HandleLinearActionUseCase; }' but required in type 'ActionHandlerRegistry'.","snippet":"actionHandlerRegistry: fakeHandlers,","context":" 88:       actionRepository: fakeActionRepository,\n 89:       actionEventPublisher: fakeActionEventPublisher,\n>90:       actionHandlerRegistry: fakeHandlers,\n 91:       logger: silentLogger,\n 92:     });"},{"type":"typecheck","code":"TS2741","file":"apps/actions-agent/src/__tests__/retryPendingActions.test.ts","line":117,"message":"Property 'code' is missing in type '{ research: HandleResearchActionUseCase; todo: HandleTodoActionUseCase; note: HandleNoteActionUseCase; link: HandleLinkActionUseCase; calendar: HandleCalendarActionUseCase; linear: HandleLinearActionUseCase; }' but required in type 'ActionHandlerRegistry'.","snippet":"actionHandlerRegistry: fakeHandlers,","context":" 115:       actionRepository: fakeActionRepository,\n 116:       actionEventPublisher: fakeActionEventPublisher,\n>117:       actionHandlerRegistry: fakeHandlers,\n 118:       logger: silentLogger,\n 119:     });"},{"type":"typecheck","code":"TS2741","file":"apps/actions-agent/src/__tests__/retryPendingActions.test.ts","line":141,"message":"Property 'code' is missing in type '{ research: HandleResearchActionUseCase; todo: HandleTodoActionUseCase; note: HandleNoteActionUseCase; link: HandleLinkActionUseCase; calendar: HandleCalendarActionUseCase; linear: HandleLinearActionUseCase; }' but required in type 'ActionHandlerRegistry'.","snippet":"actionHandlerRegistry: fakeHandlers,","context":" 139:       actionRepository: fakeActionRepository,\n 140:       actionEventPublisher: fakeActionEventPublisher,\n>141:       actionHandlerRegistry: fakeHandlers,\n 142:       logger: silentLogger,\n 143:     });"},{"type":"typecheck","code":"TS2741","file":"apps/actions-agent/src/__tests__/retryPendingActions.test.ts","line":166,"message":"Property 'code' is missing in type '{ research: HandleResearchActionUseCase; todo: HandleTodoActionUseCase; note: HandleNoteActionUseCase; link: HandleLinkActionUseCase; calendar: HandleCalendarActionUseCase; linear: HandleLinearActionUseCase; }' but required in type 'ActionHandlerRegistry'.","snippet":"actionHandlerRegistry: fakeHandlers,","context":" 164:       actionRepository: fakeActionRepository,\n 165:       actionEventPublisher: fakeActionEventPublisher,\n>166:       actionHandlerRegistry: fakeHandlers,\n 167:       logger: silentLogger,\n 168:     });"},{"type":"typecheck","code":"TS2741","file":"apps/actions-agent/src/__tests__/usecases/retryPendingActions.test.ts","line":41,"message":"Property 'code' is missing in type '{ research: { execute: Mock<Procedure>; }; todo: { execute: Mock<Procedure>; }; note: { execute: Mock<Procedure>; }; link: { execute: Mock<Procedure>; }; calendar: { ...; }; linear: { ...; }; }' but required in type 'ActionHandlerRegistry'.","snippet":"mockRegistry = {","context":" 39:       publishActionCreated: vi.fn(),\n 40:     };\n>41:     mockRegistry = {\n 42:       research: {\n 43:         execute: vi.fn().mockResolvedValue(ok({ actionId: 'action-1' })),"},{"type":"typecheck","code":"TS2322","file":"apps/actions-agent/src/infra/http/codeAgentHttpClient.ts","line":116,"message":"Type 'Result<never, { code: \"DUPLICATE\"; message: string; existingTaskId: string | undefined; }>' is not assignable to type 'Result<{ codeTaskId: string; resourceUrl: string; }, CodeAgentError>'.","snippet":"return err({","context":" 114:           const body = (await response.json()) as ErrorResponse;\n 115:           logger.info({ existingTaskId: body.existingTaskId }, 'Duplicate task detected');\n>116:           return err({\n 117:             code: 'DUPLICATE',\n 118:             message: 'Task already exists for this approval',"},{"type":"typecheck","code":"TS2322","file":"apps/commands-agent/src/domain/usecases/processCommand.ts","line":142,"message":"Type 'CommandType' is not assignable to type 'ActionType'.","snippet":"type: classification.type,","context":" 140:           userId: input.userId,\n 141:           commandId: command.id,\n>142:           type: classification.type,\n 143:           confidence: classification.confidence,\n 144:           title: classification.title,"},{"type":"typecheck","code":"TS2322","file":"apps/commands-agent/src/domain/usecases/processCommand.ts","line":185,"message":"Type 'CommandType' is not assignable to type 'ActionType'.","snippet":"actionType: classification.type,","context":" 183:           userId: input.userId,\n 184:           commandId: command.id,\n>185:           actionType: classification.type,\n 186:           title: classification.title,\n 187:           payload: eventPayload,"},{"type":"typecheck","code":"TS2322","file":"apps/commands-agent/src/domain/usecases/retryPendingCommands.ts","line":86,"message":"Type 'CommandType' is not assignable to type 'ActionType'.","snippet":"type: classification.type,","context":" 84:             userId: command.userId,\n 85:             commandId: command.id,\n>86:             type: classification.type,\n 87:             confidence: classification.confidence,\n 88:             title: classification.title,"},{"type":"typecheck","code":"TS2322","file":"apps/commands-agent/src/domain/usecases/retryPendingCommands.ts","line":116,"message":"Type 'CommandType' is not assignable to type 'ActionType'.","snippet":"actionType: classification.type,","context":" 114:             userId: command.userId,\n 115:             commandId: command.id,\n>116:             actionType: classification.type,\n 117:             title: classification.title,\n 118:             payload: eventPayload,"},{"type":"verify","code":"VERIFY_FAIL","file":"unknown","line":0,"message":"FAILED","snippet":null,"context":null}]}
{"ts":"2026-01-24T22:53:35.986Z","project":"intexuraos-3","branch":"feature/INT-245-code-action-type","runNumber":3,"passed":false,"durationMs":60910,"failureCount":2,"failures":[{"type":"typecheck","code":"TS6133","file":"apps/actions-agent/src/__tests__/fakes.ts","line":934,"message":"'actionId' is declared but its value is never read.","snippet":"return async (actionId: string): Promise<Result<ExecuteCodeActionResult, Error>> => {","context":" 932:   returnResult?: ExecuteCodeActionResult;\n 933: }): FakeExecuteCodeActionUseCase {\n>934:   return async (actionId: string): Promise<Result<ExecuteCodeActionResult, Error>> => {\n 935:     if (config?.failWithError !== undefined) {\n 936:       return err(config.failWithError);"},{"type":"verify","code":"VERIFY_FAIL","file":"unknown","line":0,"message":"FAILED","snippet":null,"context":null}]}
{"ts":"2026-01-24T22:54:55.771Z","project":"intexuraos-3","branch":"feature/INT-245-code-action-type","runNumber":4,"passed":false,"durationMs":57890,"failureCount":2,"failures":[{"type":"lint","code":"@typescript-eslint/array-type","file":"apps/actions-agent/src/__tests__/infra/http/codeAgentHttpClient.test.ts","line":408,"message":"Array type using 'Array<T>' is forbidden. Use 'T[]' instead","snippet":"const workerTypes: Array<'opus' | 'auto' | 'glm'> = ['opus', 'auto', 'glm'];","context":" 406: \n 407:     it('handles different worker types (opus, glm, auto)', async () => {\n>408:       const workerTypes: Array<'opus' | 'auto' | 'glm'> = ['opus', 'auto', 'glm'];\n 409: \n 410:       for (const workerType of workerTypes) {"},{"type":"verify","code":"VERIFY_FAIL","file":"unknown","line":0,"message":"FAILED","snippet":null,"context":null}]}
