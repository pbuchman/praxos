{"ts":"2026-01-26T02:10:32.027Z","project":"intexuraos-1","branch":"fix/INT-332-code-agent-coverage","workspace":"--","runNumber":1,"passed":false,"durationMs":24,"failureCount":0,"failures":[]}
{"ts":"2026-01-26T02:11:02.275Z","project":"intexuraos-1","branch":"fix/INT-332-code-agent-coverage","workspace":"code-agent","runNumber":2,"passed":false,"durationMs":4678,"failureCount":81,"failures":[{"type":"typecheck","code":"TS2352","file":"apps/code-agent/src/__tests__/infra/services/taskDispatcher.test.ts","line":311,"message":"Conversion of type '{ ok: true; json: () => Promise<never>; }' to type 'Response' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.","snippet":"vi.mocked(global.fetch).mockResolvedValueOnce({","context":" 309:     it('returns dispatch_failed when worker returns invalid JSON', async () => {\n 310:       const service = createTaskDispatcherService(baseDeps);\n>311:       vi.mocked(global.fetch).mockResolvedValueOnce({\n 312:         ok: true,\n 313:         json: async () => {"},{"type":"typecheck","code":"TS6133","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":21,"message":"'logger' is declared but its value is never read.","snippet":"let logger: Logger;","context":" 19: \n 20: describe('WhatsAppNotifier', () => {\n>21:   let logger: Logger;\n 22:   let mockFetchWithAuth: ReturnType<typeof vi.fn>;\n 23: "},{"type":"typecheck","code":"TS2739","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":49,"message":"Type 'Date' is missing the following properties from type 'Timestamp': seconds, nanoseconds, toDate, toMillis, isEqual","snippet":"createdAt: new Date(),","context":" 47:       webhookSecret: 'whsec_test',\n 48:       status: 'completed',\n>49:       createdAt: new Date(),\n 50:       ...overrides,\n 51:     });"},{"type":"typecheck","code":"TS2353","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":65,"message":"Object literal may only specify known properties, and 'serviceUrl' does not exist in type 'ServiceClientConfig'.","snippet":"serviceUrl: 'http://localhost:3001',","context":" 63: \n 64:       const notifier = createWhatsAppNotifier({\n>65:         serviceUrl: 'http://localhost:3001',\n 66:         internalAuthSecret: 'test-secret',\n 67:       });"},{"type":"typecheck","code":"TS2694","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":71,"message":"Namespace '\"/Users/p.buchman/personal/intexuraos-1/packages/internal-clients/src/index\"' has no exported member 'ServiceResponse'.","snippet":"} as InternalClients.ServiceResponse<void>);","context":" 69:       mockFetchWithAuth.mockResolvedValueOnce({\n 70:         ok: true,\n>71:       } as InternalClients.ServiceResponse<void>);\n 72: \n 73:       await notifier.notifyTaskComplete('user-123', task);"},{"type":"typecheck","code":"TS2532","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":84,"message":"Object is possibly 'undefined'.","snippet":"vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string","context":" 82: \n 83:       const body = JSON.parse(\n>84:         vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string\n 85:       );\n 86:       expect(body.message).toContain('PR: https://github.com/pbuchman/intexuraos/pull/123');"},{"type":"typecheck","code":"TS2375","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":95,"message":"Type '{ branch: string; commits: number; summary: string; prUrl: undefined; }' is not assignable to type 'TaskResult' with 'exactOptionalPropertyTypes: true'. Consider adding 'undefined' to the types of the target's properties.","snippet":"result: {","context":" 93:       const task = createMockTask({\n 94:         linearIssueTitle: 'Fix login bug',\n>95:         result: {\n 96:           branch: 'fix/login-bug',\n 97:           commits: 3,"},{"type":"typecheck","code":"TS2353","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":104,"message":"Object literal may only specify known properties, and 'serviceUrl' does not exist in type 'ServiceClientConfig'.","snippet":"serviceUrl: 'http://localhost:3001',","context":" 102: \n 103:       const notifier = createWhatsAppNotifier({\n>104:         serviceUrl: 'http://localhost:3001',\n 105:         internalAuthSecret: 'test-secret',\n 106:       });"},{"type":"typecheck","code":"TS2694","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":110,"message":"Namespace '\"/Users/p.buchman/personal/intexuraos-1/packages/internal-clients/src/index\"' has no exported member 'ServiceResponse'.","snippet":"} as InternalClients.ServiceResponse<void>);","context":" 108:       mockFetchWithAuth.mockResolvedValueOnce({\n 109:         ok: true,\n>110:       } as InternalClients.ServiceResponse<void>);\n 111: \n 112:       await notifier.notifyTaskComplete('user-123', task);"},{"type":"typecheck","code":"TS2532","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":115,"message":"Object is possibly 'undefined'.","snippet":"vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string","context":" 113: \n 114:       const body = JSON.parse(\n>115:         vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string\n 116:       );\n 117:       expect(body.message).not.toContain('PR:');"},{"type":"typecheck","code":"TS2322","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":129,"message":"Type 'never[]' is not assignable to type 'string'.","snippet":"prUrl: [],","context":" 127:           commits: 3,\n 128:           summary: 'Fixed login redirect handling',\n>129:           prUrl: [],\n 130:         },\n 131:       });"},{"type":"typecheck","code":"TS2353","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":134,"message":"Object literal may only specify known properties, and 'serviceUrl' does not exist in type 'ServiceClientConfig'.","snippet":"serviceUrl: 'http://localhost:3001',","context":" 132: \n 133:       const notifier = createWhatsAppNotifier({\n>134:         serviceUrl: 'http://localhost:3001',\n 135:         internalAuthSecret: 'test-secret',\n 136:       });"},{"type":"typecheck","code":"TS2694","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":140,"message":"Namespace '\"/Users/p.buchman/personal/intexuraos-1/packages/internal-clients/src/index\"' has no exported member 'ServiceResponse'.","snippet":"} as InternalClients.ServiceResponse<void>);","context":" 138:       mockFetchWithAuth.mockResolvedValueOnce({\n 139:         ok: true,\n>140:       } as InternalClients.ServiceResponse<void>);\n 141: \n 142:       await notifier.notifyTaskComplete('user-123', task);"},{"type":"typecheck","code":"TS2532","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":145,"message":"Object is possibly 'undefined'.","snippet":"vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string","context":" 143: \n 144:       const body = JSON.parse(\n>145:         vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string\n 146:       );\n 147:       expect(body.message).not.toContain('PR:');"},{"type":"typecheck","code":"TS2379","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":152,"message":"Argument of type '{ prompt: string; linearIssueTitle: undefined; result: { branch: string; commits: number; summary: string; }; }' is not assignable to parameter of type 'Partial<CodeTask>' with 'exactOptionalPropertyTypes: true'. Consider adding 'undefined' to the types of the target's properties.","snippet":"const task = createMockTask({","context":" 150:     it('truncates long prompt when Linear title is missing', async () => {\n 151:       const longPrompt = 'Fix the bug in the authentication system that causes issues when users try to log in with invalid credentials';\n>152:       const task = createMockTask({\n 153:         prompt: longPrompt,\n 154:         linearIssueTitle: undefined,"},{"type":"typecheck","code":"TS2353","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":163,"message":"Object literal may only specify known properties, and 'serviceUrl' does not exist in type 'ServiceClientConfig'.","snippet":"serviceUrl: 'http://localhost:3001',","context":" 161: \n 162:       const notifier = createWhatsAppNotifier({\n>163:         serviceUrl: 'http://localhost:3001',\n 164:         internalAuthSecret: 'test-secret',\n 165:       });"},{"type":"typecheck","code":"TS2694","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":169,"message":"Namespace '\"/Users/p.buchman/personal/intexuraos-1/packages/internal-clients/src/index\"' has no exported member 'ServiceResponse'.","snippet":"} as InternalClients.ServiceResponse<void>);","context":" 167:       mockFetchWithAuth.mockResolvedValueOnce({\n 168:         ok: true,\n>169:       } as InternalClients.ServiceResponse<void>);\n 170: \n 171:       await notifier.notifyTaskComplete('user-123', task);"},{"type":"typecheck","code":"TS2532","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":174,"message":"Object is possibly 'undefined'.","snippet":"vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string","context":" 172: \n 173:       const body = JSON.parse(\n>174:         vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string\n 175:       );\n 176:       expect(body.message).toContain('✅ Code task completed: Fix the bug in the authentication system that caus');"},{"type":"typecheck","code":"TS2353","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":191,"message":"Object literal may only specify known properties, and 'serviceUrl' does not exist in type 'ServiceClientConfig'.","snippet":"serviceUrl: 'http://localhost:3001',","context":" 189: \n 190:       const notifier = createWhatsAppNotifier({\n>191:         serviceUrl: 'http://localhost:3001',\n 192:         internalAuthSecret: 'test-secret',\n 193:       });"},{"type":"typecheck","code":"TS2694","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":197,"message":"Namespace '\"/Users/p.buchman/personal/intexuraos-1/packages/internal-clients/src/index\"' has no exported member 'ServiceResponse'.","snippet":"} as InternalClients.ServiceResponse<void>);","context":" 195:       mockFetchWithAuth.mockResolvedValueOnce({\n 196:         ok: true,\n>197:       } as InternalClients.ServiceResponse<void>);\n 198: \n 199:       await notifier.notifyTaskComplete('user-123', task);"},{"type":"typecheck","code":"TS2532","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":202,"message":"Object is possibly 'undefined'.","snippet":"vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string","context":" 200: \n 201:       const body = JSON.parse(\n>202:         vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string\n 203:       );\n 204:       expect(body.message).toContain('⚠️ (Linear unavailable - no issue tracking)');"},{"type":"typecheck","code":"TS2353","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":219,"message":"Object literal may only specify known properties, and 'serviceUrl' does not exist in type 'ServiceClientConfig'.","snippet":"serviceUrl: 'http://localhost:3001',","context":" 217: \n 218:       const notifier = createWhatsAppNotifier({\n>219:         serviceUrl: 'http://localhost:3001',\n 220:         internalAuthSecret: 'test-secret',\n 221:       });"},{"type":"typecheck","code":"TS2694","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":225,"message":"Namespace '\"/Users/p.buchman/personal/intexuraos-1/packages/internal-clients/src/index\"' has no exported member 'ServiceResponse'.","snippet":"} as InternalClients.ServiceResponse<void>);","context":" 223:       mockFetchWithAuth.mockResolvedValueOnce({\n 224:         ok: true,\n>225:       } as InternalClients.ServiceResponse<void>);\n 226: \n 227:       await notifier.notifyTaskComplete('user-123', task);"},{"type":"typecheck","code":"TS2532","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":230,"message":"Object is possibly 'undefined'.","snippet":"vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string","context":" 228: \n 229:       const body = JSON.parse(\n>230:         vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string\n 231:       );\n 232:       expect(body.message).not.toContain('⚠️ (Linear unavailable');"},{"type":"typecheck","code":"TS2379","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":236,"message":"Argument of type '{ linearIssueTitle: string; linearFallback: undefined; result: { branch: string; commits: number; summary: string; }; }' is not assignable to parameter of type 'Partial<CodeTask>' with 'exactOptionalPropertyTypes: true'. Consider adding 'undefined' to the types of the target's properties.","snippet":"const task = createMockTask({","context":" 234: \n 235:     it('includes Linear fallback warning when linearFallback is undefined', async () => {\n>236:       const task = createMockTask({\n 237:         linearIssueTitle: 'Fix login bug',\n 238:         linearFallback: undefined,"},{"type":"typecheck","code":"TS2353","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":247,"message":"Object literal may only specify known properties, and 'serviceUrl' does not exist in type 'ServiceClientConfig'.","snippet":"serviceUrl: 'http://localhost:3001',","context":" 245: \n 246:       const notifier = createWhatsAppNotifier({\n>247:         serviceUrl: 'http://localhost:3001',\n 248:         internalAuthSecret: 'test-secret',\n 249:       });"},{"type":"typecheck","code":"TS2694","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":253,"message":"Namespace '\"/Users/p.buchman/personal/intexuraos-1/packages/internal-clients/src/index\"' has no exported member 'ServiceResponse'.","snippet":"} as InternalClients.ServiceResponse<void>);","context":" 251:       mockFetchWithAuth.mockResolvedValueOnce({\n 252:         ok: true,\n>253:       } as InternalClients.ServiceResponse<void>);\n 254: \n 255:       await notifier.notifyTaskComplete('user-123', task);"},{"type":"typecheck","code":"TS2532","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":258,"message":"Object is possibly 'undefined'.","snippet":"vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string","context":" 256: \n 257:       const body = JSON.parse(\n>258:         vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string\n 259:       );\n 260:       expect(body.message).not.toContain('⚠️ (Linear unavailable');"},{"type":"typecheck","code":"TS2353","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":275,"message":"Object literal may only specify known properties, and 'serviceUrl' does not exist in type 'ServiceClientConfig'.","snippet":"serviceUrl: 'http://localhost:3001',","context":" 273: \n 274:       const notifier = createWhatsAppNotifier({\n>275:         serviceUrl: 'http://localhost:3001',\n 276:         internalAuthSecret: 'test-secret',\n 277:       });"},{"type":"typecheck","code":"TS2694","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":281,"message":"Namespace '\"/Users/p.buchman/personal/intexuraos-1/packages/internal-clients/src/index\"' has no exported member 'ServiceResponse'.","snippet":"} as InternalClients.ServiceResponse<void>);","context":" 279:       mockFetchWithAuth.mockResolvedValueOnce({\n 280:         ok: true,\n>281:       } as InternalClients.ServiceResponse<void>);\n 282: \n 283:       await notifier.notifyTaskComplete('user-123', task);"},{"type":"typecheck","code":"TS2532","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":286,"message":"Object is possibly 'undefined'.","snippet":"vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string","context":" 284: \n 285:       const body = JSON.parse(\n>286:         vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string\n 287:       );\n 288:       expect(body.message).toContain('✅ Code task completed: INT-123 Fix auth bug');"},{"type":"typecheck","code":"TS2379","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":293,"message":"Argument of type '{ linearIssueTitle: string; result: undefined; }' is not assignable to parameter of type 'Partial<CodeTask>' with 'exactOptionalPropertyTypes: true'. Consider adding 'undefined' to the types of the target's properties.","snippet":"const task = createMockTask({","context":" 291: \n 292:     it('handles completion without result', async () => {\n>293:       const task = createMockTask({\n 294:         linearIssueTitle: 'Fix login bug',\n 295:         result: undefined,"},{"type":"typecheck","code":"TS2353","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":299,"message":"Object literal may only specify known properties, and 'serviceUrl' does not exist in type 'ServiceClientConfig'.","snippet":"serviceUrl: 'http://localhost:3001',","context":" 297: \n 298:       const notifier = createWhatsAppNotifier({\n>299:         serviceUrl: 'http://localhost:3001',\n 300:         internalAuthSecret: 'test-secret',\n 301:       });"},{"type":"typecheck","code":"TS2694","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":305,"message":"Namespace '\"/Users/p.buchman/personal/intexuraos-1/packages/internal-clients/src/index\"' has no exported member 'ServiceResponse'.","snippet":"} as InternalClients.ServiceResponse<void>);","context":" 303:       mockFetchWithAuth.mockResolvedValueOnce({\n 304:         ok: true,\n>305:       } as InternalClients.ServiceResponse<void>);\n 306: \n 307:       await notifier.notifyTaskComplete('user-123', task);"},{"type":"typecheck","code":"TS2532","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":310,"message":"Object is possibly 'undefined'.","snippet":"vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string","context":" 308: \n 309:       const body = JSON.parse(\n>310:         vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string\n 311:       );\n 312:       expect(body.message).toBe('✅ Code task completed: Fix login bug');"},{"type":"typecheck","code":"TS2739","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":329,"message":"Type 'Date' is missing the following properties from type 'Timestamp': seconds, nanoseconds, toDate, toMillis, isEqual","snippet":"createdAt: new Date(),","context":" 327:       webhookSecret: 'whsec_test',\n 328:       status: 'failed',\n>329:       createdAt: new Date(),\n 330:       ...overrides,\n 331:     });"},{"type":"typecheck","code":"TS2353","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":346,"message":"Object literal may only specify known properties, and 'serviceUrl' does not exist in type 'ServiceClientConfig'.","snippet":"serviceUrl: 'http://localhost:3001',","context":" 344: \n 345:       const notifier = createWhatsAppNotifier({\n>346:         serviceUrl: 'http://localhost:3001',\n 347:         internalAuthSecret: 'test-secret',\n 348:       });"},{"type":"typecheck","code":"TS2694","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":352,"message":"Namespace '\"/Users/p.buchman/personal/intexuraos-1/packages/internal-clients/src/index\"' has no exported member 'ServiceResponse'.","snippet":"} as InternalClients.ServiceResponse<void>);","context":" 350:       mockFetchWithAuth.mockResolvedValueOnce({\n 351:         ok: true,\n>352:       } as InternalClients.ServiceResponse<void>);\n 353: \n 354:       await notifier.notifyTaskFailed('user-123', task, error);"},{"type":"typecheck","code":"TS2532","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":357,"message":"Object is possibly 'undefined'.","snippet":"vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string","context":" 355: \n 356:       const body = JSON.parse(\n>357:         vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string\n 358:       );\n 359:       expect(body.message).toContain('❌ Code task failed: Fix login bug');"},{"type":"typecheck","code":"TS2353","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":375,"message":"Object literal may only specify known properties, and 'serviceUrl' does not exist in type 'ServiceClientConfig'.","snippet":"serviceUrl: 'http://localhost:3001',","context":" 373: \n 374:       const notifier = createWhatsAppNotifier({\n>375:         serviceUrl: 'http://localhost:3001',\n 376:         internalAuthSecret: 'test-secret',\n 377:       });"},{"type":"typecheck","code":"TS2694","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":381,"message":"Namespace '\"/Users/p.buchman/personal/intexuraos-1/packages/internal-clients/src/index\"' has no exported member 'ServiceResponse'.","snippet":"} as InternalClients.ServiceResponse<void>);","context":" 379:       mockFetchWithAuth.mockResolvedValueOnce({\n 380:         ok: true,\n>381:       } as InternalClients.ServiceResponse<void>);\n 382: \n 383:       await notifier.notifyTaskFailed('user-123', task, error);"},{"type":"typecheck","code":"TS2532","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":386,"message":"Object is possibly 'undefined'.","snippet":"vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string","context":" 384: \n 385:       const body = JSON.parse(\n>386:         vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string\n 387:       );\n 388:       expect(body.message).toContain('Suggestion: Check the logs');"},{"type":"typecheck","code":"TS2353","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":403,"message":"Object literal may only specify known properties, and 'serviceUrl' does not exist in type 'ServiceClientConfig'.","snippet":"serviceUrl: 'http://localhost:3001',","context":" 401: \n 402:       const notifier = createWhatsAppNotifier({\n>403:         serviceUrl: 'http://localhost:3001',\n 404:         internalAuthSecret: 'test-secret',\n 405:       });"},{"type":"typecheck","code":"TS2694","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":409,"message":"Namespace '\"/Users/p.buchman/personal/intexuraos-1/packages/internal-clients/src/index\"' has no exported member 'ServiceResponse'.","snippet":"} as InternalClients.ServiceResponse<void>);","context":" 407:       mockFetchWithAuth.mockResolvedValueOnce({\n 408:         ok: true,\n>409:       } as InternalClients.ServiceResponse<void>);\n 410: \n 411:       await notifier.notifyTaskFailed('user-123', task, error);"},{"type":"typecheck","code":"TS2532","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":414,"message":"Object is possibly 'undefined'.","snippet":"vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string","context":" 412: \n 413:       const body = JSON.parse(\n>414:         vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string\n 415:       );\n 416:       expect(body.message).not.toContain('Suggestion:');"},{"type":"typecheck","code":"TS2375","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":425,"message":"Type '{ manualSteps: undefined; }' is not assignable to type '{ retryAfter?: number; manualSteps?: string; supportLink?: string; }' with 'exactOptionalPropertyTypes: true'. Consider adding 'undefined' to the types of the target's properties.","snippet":"remediation: {","context":" 423:       const error = createMockError({\n 424:         message: 'Test error occurred',\n>425:         remediation: {\n 426:           manualSteps: undefined,\n 427:         },"},{"type":"typecheck","code":"TS2353","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":431,"message":"Object literal may only specify known properties, and 'serviceUrl' does not exist in type 'ServiceClientConfig'.","snippet":"serviceUrl: 'http://localhost:3001',","context":" 429: \n 430:       const notifier = createWhatsAppNotifier({\n>431:         serviceUrl: 'http://localhost:3001',\n 432:         internalAuthSecret: 'test-secret',\n 433:       });"},{"type":"typecheck","code":"TS2694","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":437,"message":"Namespace '\"/Users/p.buchman/personal/intexuraos-1/packages/internal-clients/src/index\"' has no exported member 'ServiceResponse'.","snippet":"} as InternalClients.ServiceResponse<void>);","context":" 435:       mockFetchWithAuth.mockResolvedValueOnce({\n 436:         ok: true,\n>437:       } as InternalClients.ServiceResponse<void>);\n 438: \n 439:       await notifier.notifyTaskFailed('user-123', task, error);"},{"type":"typecheck","code":"TS2532","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":442,"message":"Object is possibly 'undefined'.","snippet":"vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string","context":" 440: \n 441:       const body = JSON.parse(\n>442:         vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string\n 443:       );\n 444:       expect(body.message).not.toContain('Suggestion:');"},{"type":"typecheck","code":"TS2379","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":451,"message":"Argument of type '{ message: string; remediation: undefined; }' is not assignable to parameter of type 'Partial<TaskError>' with 'exactOptionalPropertyTypes: true'. Consider adding 'undefined' to the types of the target's properties.","snippet":"const error = createMockError({","context":" 449:         linearIssueTitle: 'Fix login bug',\n 450:       });\n>451:       const error = createMockError({\n 452:         message: 'Test error occurred',\n 453:         remediation: undefined,"},{"type":"typecheck","code":"TS2353","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":457,"message":"Object literal may only specify known properties, and 'serviceUrl' does not exist in type 'ServiceClientConfig'.","snippet":"serviceUrl: 'http://localhost:3001',","context":" 455: \n 456:       const notifier = createWhatsAppNotifier({\n>457:         serviceUrl: 'http://localhost:3001',\n 458:         internalAuthSecret: 'test-secret',\n 459:       });"},{"type":"typecheck","code":"TS2694","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":463,"message":"Namespace '\"/Users/p.buchman/personal/intexuraos-1/packages/internal-clients/src/index\"' has no exported member 'ServiceResponse'.","snippet":"} as InternalClients.ServiceResponse<void>);","context":" 461:       mockFetchWithAuth.mockResolvedValueOnce({\n 462:         ok: true,\n>463:       } as InternalClients.ServiceResponse<void>);\n 464: \n 465:       await notifier.notifyTaskFailed('user-123', task, error);"},{"type":"typecheck","code":"TS2532","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":468,"message":"Object is possibly 'undefined'.","snippet":"vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string","context":" 466: \n 467:       const body = JSON.parse(\n>468:         vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string\n 469:       );\n 470:       expect(body.message).not.toContain('Suggestion:');"},{"type":"typecheck","code":"TS2353","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":481,"message":"Object literal may only specify known properties, and 'serviceUrl' does not exist in type 'ServiceClientConfig'.","snippet":"serviceUrl: 'http://localhost:3001',","context":" 479: \n 480:       const notifier = createWhatsAppNotifier({\n>481:         serviceUrl: 'http://localhost:3001',\n 482:         internalAuthSecret: 'test-secret',\n 483:       });"},{"type":"typecheck","code":"TS2694","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":487,"message":"Namespace '\"/Users/p.buchman/personal/intexuraos-1/packages/internal-clients/src/index\"' has no exported member 'ServiceResponse'.","snippet":"} as InternalClients.ServiceResponse<void>);","context":" 485:       mockFetchWithAuth.mockResolvedValueOnce({\n 486:         ok: true,\n>487:       } as InternalClients.ServiceResponse<void>);\n 488: \n 489:       await notifier.notifyTaskFailed('user-123', task, error);"},{"type":"typecheck","code":"TS2532","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":492,"message":"Object is possibly 'undefined'.","snippet":"vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string","context":" 490: \n 491:       const body = JSON.parse(\n>492:         vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string\n 493:       );\n 494:       expect(body.message).toContain('⚠️ (Linear unavailable - no issue tracking)');"},{"type":"typecheck","code":"TS2353","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":505,"message":"Object literal may only specify known properties, and 'serviceUrl' does not exist in type 'ServiceClientConfig'.","snippet":"serviceUrl: 'http://localhost:3001',","context":" 503: \n 504:       const notifier = createWhatsAppNotifier({\n>505:         serviceUrl: 'http://localhost:3001',\n 506:         internalAuthSecret: 'test-secret',\n 507:       });"},{"type":"typecheck","code":"TS2694","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":511,"message":"Namespace '\"/Users/p.buchman/personal/intexuraos-1/packages/internal-clients/src/index\"' has no exported member 'ServiceResponse'.","snippet":"} as InternalClients.ServiceResponse<void>);","context":" 509:       mockFetchWithAuth.mockResolvedValueOnce({\n 510:         ok: true,\n>511:       } as InternalClients.ServiceResponse<void>);\n 512: \n 513:       await notifier.notifyTaskFailed('user-123', task, error);"},{"type":"typecheck","code":"TS2532","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":516,"message":"Object is possibly 'undefined'.","snippet":"vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string","context":" 514: \n 515:       const body = JSON.parse(\n>516:         vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string\n 517:       );\n 518:       expect(body.message).not.toContain('⚠️ (Linear unavailable');"},{"type":"typecheck","code":"TS2379","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":523,"message":"Argument of type '{ prompt: string; linearIssueTitle: undefined; }' is not assignable to parameter of type 'Partial<CodeTask>' with 'exactOptionalPropertyTypes: true'. Consider adding 'undefined' to the types of the target's properties.","snippet":"const task = createMockTask({","context":" 521:     it('truncates long prompt when Linear title is missing', async () => {\n 522:       const longPrompt = 'Fix the bug in the authentication system that causes issues when users try to log in with invalid credentials';\n>523:       const task = createMockTask({\n 524:         prompt: longPrompt,\n 525:         linearIssueTitle: undefined,"},{"type":"typecheck","code":"TS2353","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":530,"message":"Object literal may only specify known properties, and 'serviceUrl' does not exist in type 'ServiceClientConfig'.","snippet":"serviceUrl: 'http://localhost:3001',","context":" 528: \n 529:       const notifier = createWhatsAppNotifier({\n>530:         serviceUrl: 'http://localhost:3001',\n 531:         internalAuthSecret: 'test-secret',\n 532:       });"},{"type":"typecheck","code":"TS2694","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":536,"message":"Namespace '\"/Users/p.buchman/personal/intexuraos-1/packages/internal-clients/src/index\"' has no exported member 'ServiceResponse'.","snippet":"} as InternalClients.ServiceResponse<void>);","context":" 534:       mockFetchWithAuth.mockResolvedValueOnce({\n 535:         ok: true,\n>536:       } as InternalClients.ServiceResponse<void>);\n 537: \n 538:       await notifier.notifyTaskFailed('user-123', task, error);"},{"type":"typecheck","code":"TS2532","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":541,"message":"Object is possibly 'undefined'.","snippet":"vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string","context":" 539: \n 540:       const body = JSON.parse(\n>541:         vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string\n 542:       );\n 543:       // Prompt is truncated to 50 chars: \"Fix the bug in the authentication system that caus\""},{"type":"typecheck","code":"TS2353","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":555,"message":"Object literal may only specify known properties, and 'serviceUrl' does not exist in type 'ServiceClientConfig'.","snippet":"serviceUrl: 'http://localhost:3001',","context":" 553: \n 554:       const notifier = createWhatsAppNotifier({\n>555:         serviceUrl: 'http://localhost:3001',\n 556:         internalAuthSecret: 'test-secret',\n 557:       });"},{"type":"typecheck","code":"TS2694","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":561,"message":"Namespace '\"/Users/p.buchman/personal/intexuraos-1/packages/internal-clients/src/index\"' has no exported member 'ServiceResponse'.","snippet":"} as InternalClients.ServiceResponse<void>);","context":" 559:       mockFetchWithAuth.mockResolvedValueOnce({\n 560:         ok: true,\n>561:       } as InternalClients.ServiceResponse<void>);\n 562: \n 563:       await notifier.notifyTaskFailed('user-123', task, error);"},{"type":"typecheck","code":"TS2532","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":566,"message":"Object is possibly 'undefined'.","snippet":"vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string","context":" 564: \n 565:       const body = JSON.parse(\n>566:         vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string\n 567:       );\n 568:       expect(body.message).toContain('❌ Code task failed: INT-123 Fix auth bug');"},{"type":"typecheck","code":"TS2353","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":594,"message":"Object literal may only specify known properties, and 'serviceUrl' does not exist in type 'ServiceClientConfig'.","snippet":"serviceUrl: 'http://localhost:3001',","context":" 592: \n 593:       const notifier = createWhatsAppNotifier({\n>594:         serviceUrl: 'http://localhost:3001',\n 595:         internalAuthSecret: 'test-secret',\n 596:       });"},{"type":"typecheck","code":"TS2694","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":600,"message":"Namespace '\"/Users/p.buchman/personal/intexuraos-1/packages/internal-clients/src/index\"' has no exported member 'ServiceResponse'.","snippet":"} as InternalClients.ServiceResponse<void>);","context":" 598:       mockFetchWithAuth.mockResolvedValueOnce({\n 599:         ok: true,\n>600:       } as InternalClients.ServiceResponse<void>);\n 601: \n 602:       const result = await notifier.notifyTaskComplete('user-123', task);"},{"type":"typecheck","code":"TS2345","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":602,"message":"Argument of type '{ id: string; prompt: string; systemPromptHash: string; repository: string; baseBranch: string; workerType: string; webhookUrl: string; webhookSecret: string; status: \"completed\"; createdAt: Date; result: { ...; }; }' is not assignable to parameter of type 'CodeTask'.","snippet":"const result = await notifier.notifyTaskComplete('user-123', task);","context":" 600:       } as InternalClients.ServiceResponse<void>);\n 601: \n>602:       const result = await notifier.notifyTaskComplete('user-123', task);\n 603: \n 604:       expect(result.ok).toBe(true);"},{"type":"typecheck","code":"TS2532","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":620,"message":"Object is possibly 'undefined'.","snippet":"vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string","context":" 618: \n 619:       const body = JSON.parse(\n>620:         vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string\n 621:       );\n 622:       expect(body.userId).toBe('user-123');"},{"type":"typecheck","code":"TS2353","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":646,"message":"Object literal may only specify known properties, and 'serviceUrl' does not exist in type 'ServiceClientConfig'.","snippet":"serviceUrl: 'http://localhost:3001',","context":" 644: \n 645:       const notifier = createWhatsAppNotifier({\n>646:         serviceUrl: 'http://localhost:3001',\n 647:         internalAuthSecret: 'test-secret',\n 648:       });"},{"type":"typecheck","code":"TS2694","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":653,"message":"Namespace '\"/Users/p.buchman/personal/intexuraos-1/packages/internal-clients/src/index\"' has no exported member 'ServiceResponse'.","snippet":"} as InternalClients.ServiceResponse<void>);","context":" 651:         ok: false,\n 652:         error: { message: 'Service unavailable', code: 'service_error' },\n>653:       } as InternalClients.ServiceResponse<void>);\n 654: \n 655:       const result = await notifier.notifyTaskComplete('user-123', task);"},{"type":"typecheck","code":"TS2345","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":655,"message":"Argument of type '{ id: string; prompt: string; systemPromptHash: string; repository: string; baseBranch: string; workerType: string; webhookUrl: string; webhookSecret: string; status: \"completed\"; createdAt: Date; result: { ...; }; }' is not assignable to parameter of type 'CodeTask'.","snippet":"const result = await notifier.notifyTaskComplete('user-123', task);","context":" 653:       } as InternalClients.ServiceResponse<void>);\n 654: \n>655:       const result = await notifier.notifyTaskComplete('user-123', task);\n 656: \n 657:       expect(result.ok).toBe(false);"},{"type":"typecheck","code":"TS2353","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":685,"message":"Object literal may only specify known properties, and 'serviceUrl' does not exist in type 'ServiceClientConfig'.","snippet":"serviceUrl: 'http://localhost:3001',","context":" 683: \n 684:       const notifier = createWhatsAppNotifier({\n>685:         serviceUrl: 'http://localhost:3001',\n 686:         internalAuthSecret: 'test-secret',\n 687:       });"},{"type":"typecheck","code":"TS2694","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":691,"message":"Namespace '\"/Users/p.buchman/personal/intexuraos-1/packages/internal-clients/src/index\"' has no exported member 'ServiceResponse'.","snippet":"} as InternalClients.ServiceResponse<void>);","context":" 689:       mockFetchWithAuth.mockResolvedValueOnce({\n 690:         ok: true,\n>691:       } as InternalClients.ServiceResponse<void>);\n 692: \n 693:       const result = await notifier.notifyTaskFailed('user-123', task, error);"},{"type":"typecheck","code":"TS2345","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":693,"message":"Argument of type '{ id: string; prompt: string; systemPromptHash: string; repository: string; baseBranch: string; workerType: string; webhookUrl: string; webhookSecret: string; status: \"failed\"; createdAt: Date; }' is not assignable to parameter of type 'CodeTask'.","snippet":"const result = await notifier.notifyTaskFailed('user-123', task, error);","context":" 691:       } as InternalClients.ServiceResponse<void>);\n 692: \n>693:       const result = await notifier.notifyTaskFailed('user-123', task, error);\n 694: \n 695:       expect(result.ok).toBe(true);"},{"type":"typecheck","code":"TS2532","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":697,"message":"Object is possibly 'undefined'.","snippet":"vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string","context":" 695:       expect(result.ok).toBe(true);\n 696:       const body = JSON.parse(\n>697:         vi.mocked(mockFetchWithAuth).mock.calls[0][2].body as string\n 698:       );\n 699:       expect(body.userId).toBe('user-123');"},{"type":"typecheck","code":"TS2353","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":722,"message":"Object literal may only specify known properties, and 'serviceUrl' does not exist in type 'ServiceClientConfig'.","snippet":"serviceUrl: 'http://localhost:3001',","context":" 720: \n 721:       const notifier = createWhatsAppNotifier({\n>722:         serviceUrl: 'http://localhost:3001',\n 723:         internalAuthSecret: 'test-secret',\n 724:       });"},{"type":"typecheck","code":"TS2694","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":729,"message":"Namespace '\"/Users/p.buchman/personal/intexuraos-1/packages/internal-clients/src/index\"' has no exported member 'ServiceResponse'.","snippet":"} as InternalClients.ServiceResponse<void>);","context":" 727:         ok: false,\n 728:         error: { message: 'Service unavailable', code: 'service_error' },\n>729:       } as InternalClients.ServiceResponse<void>);\n 730: \n 731:       const result = await notifier.notifyTaskFailed('user-123', task, error);"},{"type":"typecheck","code":"TS2345","file":"apps/code-agent/src/__tests__/infra/services/whatsappNotifier.test.ts","line":731,"message":"Argument of type '{ id: string; prompt: string; systemPromptHash: string; repository: string; baseBranch: string; workerType: string; webhookUrl: string; webhookSecret: string; status: \"failed\"; createdAt: Date; }' is not assignable to parameter of type 'CodeTask'.","snippet":"const result = await notifier.notifyTaskFailed('user-123', task, error);","context":" 729:       } as InternalClients.ServiceResponse<void>);\n 730: \n>731:       const result = await notifier.notifyTaskFailed('user-123', task, error);\n 732: \n 733:       expect(result.ok).toBe(false);"},{"type":"typecheck","code":"TS2352","file":"apps/code-agent/src/__tests__/infra/services/workerDiscovery.test.ts","line":176,"message":"Conversion of type '{ ok: true; json: () => Promise<never>; }' to type 'Response' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.","snippet":"const mockFetch = vi.spyOn(global, 'fetch').mockResolvedValueOnce({","context":" 174:     it('returns health_check_failed when worker returns invalid JSON', async () => {\n 175:       const service = createWorkerDiscoveryService({ logger });\n>176:       const mockFetch = vi.spyOn(global, 'fetch').mockResolvedValueOnce({\n 177:         ok: true,\n 178:         json: async () => {"}]}
