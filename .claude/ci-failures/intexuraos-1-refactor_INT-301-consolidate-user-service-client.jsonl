{"ts":"2026-01-25T22:59:44.590Z","project":"intexuraos-1","branch":"refactor/INT-301-consolidate-user-service-client","workspace":"--","runNumber":1,"passed":false,"durationMs":330,"failureCount":0,"failures":[]}
{"ts":"2026-01-25T23:14:34.870Z","project":"intexuraos-1","branch":"refactor/INT-301-consolidate-user-service-client","runNumber":2,"passed":false,"durationMs":65630,"failureCount":97,"failures":[{"type":"typecheck","code":"TS2420","file":"apps/actions-agent/src/__tests__/fakes.ts","line":1074,"message":"Class 'FakeUserServiceClient' incorrectly implements interface 'UserServiceClient'.","snippet":"export class FakeUserServiceClient implements UserServiceClient {","context":" 1072: \n 1073: // Fake UserServiceClient\n>1074: export class FakeUserServiceClient implements UserServiceClient {\n 1075:   private llmClient: LlmGenerateClient | null = null;\n 1076:   private error: UserServiceError | null = null;"},{"type":"typecheck","code":"TS2741","file":"apps/actions-agent/src/__tests__/fakes.ts","line":1332,"message":"Property 'getOAuthToken' is missing in type 'FakeUserServiceClient' but required in type 'UserServiceClient'.","snippet":"userServiceClient,","context":" 1330:     changeActionTypeUseCase,\n 1331:     approvalMessageRepository,\n>1332:     userServiceClient,\n 1333:     handleApprovalReplyUseCase:\n 1334:       deps.handleApprovalReplyUseCase ?? createFakeHandleApprovalReplyUseCase(),"},{"type":"typecheck","code":"TS2741","file":"apps/calendar-agent/src/__tests__/calendarActionExtractionService.test.ts","line":56,"message":"Property 'getOAuthToken' is missing in type '{ getLlmClient: Mock<Procedure>; getApiKeys: Mock<Procedure>; reportLlmSuccess: Mock<Procedure>; }' but required in type 'UserServiceClient'.","snippet":"return {","context":" 54:     switch (result) {\n 55:       case 'ok':\n>56:         return {\n 57:           getLlmClient: vi.fn().mockResolvedValue(ok(mockLlmClient)),\n 58:         getApiKeys: vi.fn(),"},{"type":"typecheck","code":"TS2741","file":"apps/calendar-agent/src/__tests__/calendarActionExtractionService.test.ts","line":61,"message":"Property 'getOAuthToken' is missing in type '{ getLlmClient: Mock<Procedure>; getApiKeys: Mock<Procedure>; reportLlmSuccess: Mock<Procedure>; }' but required in type 'UserServiceClient'.","snippet":"return {","context":" 59:         reportLlmSuccess: vi.fn()        };\n 60:       case 'no_api_key':\n>61:         return {\n 62:           getLlmClient: vi\n 63:             .fn()"},{"type":"typecheck","code":"TS2741","file":"apps/calendar-agent/src/__tests__/calendarActionExtractionService.test.ts","line":69,"message":"Property 'getOAuthToken' is missing in type '{ getLlmClient: Mock<Procedure>; getApiKeys: Mock<Procedure>; reportLlmSuccess: Mock<Procedure>; }' but required in type 'UserServiceClient'.","snippet":"return {","context":" 67:         };\n 68:       case 'api_error':\n>69:         return {\n 70:           getLlmClient: vi.fn().mockResolvedValue(err({ code: 'API_ERROR' as const, message: 'Service error' })),\n 71:         getApiKeys: vi.fn(),"},{"type":"typecheck","code":"TS2741","file":"apps/calendar-agent/src/__tests__/calendarActionExtractionService.test.ts","line":74,"message":"Property 'getOAuthToken' is missing in type '{ getLlmClient: Mock<Procedure>; getApiKeys: Mock<Procedure>; reportLlmSuccess: Mock<Procedure>; }' but required in type 'UserServiceClient'.","snippet":"return {","context":" 72:         reportLlmSuccess: vi.fn()        };\n 73:       case 'network_error':\n>74:         return {\n 75:           getLlmClient: vi\n 76:             .fn()"},{"type":"typecheck","code":"TS2741","file":"apps/calendar-agent/src/__tests__/calendarActionExtractionService.test.ts","line":82,"message":"Property 'getOAuthToken' is missing in type '{ getLlmClient: Mock<Procedure>; getApiKeys: Mock<Procedure>; reportLlmSuccess: Mock<Procedure>; }' but required in type 'UserServiceClient'.","snippet":"return {","context":" 80:         };\n 81:       case 'invalid_model':\n>82:         return {\n 83:           getLlmClient: vi\n 84:             .fn()"},{"type":"typecheck","code":"TS2345","file":"apps/calendar-agent/src/__tests__/calendarRoutes.test.ts","line":163,"message":"Argument of type '\"NOT_CONNECTED\"' is not assignable to parameter of type '\"NETWORK_ERROR\" | \"NO_API_KEY\" | \"INVALID_MODEL\" | \"API_ERROR\" | \"CONNECTION_NOT_FOUND\" | \"TOKEN_REFRESH_FAILED\" | \"OAUTH_NOT_CONFIGURED\"'.","snippet":"fakeUserService.setTokenError('NOT_CONNECTED', 'Google Calendar not connected');","context":" 161:     it('returns 403 when not connected', async () => {\n 162:       const jwt = await createJwt('user-123');\n>163:       fakeUserService.setTokenError('NOT_CONNECTED', 'Google Calendar not connected');\n 164: \n 165:       const response = await app.inject({"},{"type":"typecheck","code":"TS2345","file":"apps/calendar-agent/src/__tests__/calendarRoutes.test.ts","line":177,"message":"Argument of type '\"TOKEN_ERROR\"' is not assignable to parameter of type '\"NETWORK_ERROR\" | \"NO_API_KEY\" | \"INVALID_MODEL\" | \"API_ERROR\" | \"CONNECTION_NOT_FOUND\" | \"TOKEN_REFRESH_FAILED\" | \"OAUTH_NOT_CONFIGURED\"'.","snippet":"fakeUserService.setTokenError('TOKEN_ERROR', 'Token expired');","context":" 175:     it('returns 401 on token error', async () => {\n 176:       const jwt = await createJwt('user-123');\n>177:       fakeUserService.setTokenError('TOKEN_ERROR', 'Token expired');\n 178: \n 179:       const response = await app.inject({"},{"type":"typecheck","code":"TS2345","file":"apps/calendar-agent/src/__tests__/calendarRoutes.test.ts","line":269,"message":"Argument of type '\"NOT_CONNECTED\"' is not assignable to parameter of type '\"NETWORK_ERROR\" | \"NO_API_KEY\" | \"INVALID_MODEL\" | \"API_ERROR\" | \"CONNECTION_NOT_FOUND\" | \"TOKEN_REFRESH_FAILED\" | \"OAUTH_NOT_CONFIGURED\"'.","snippet":"fakeUserService.setTokenError('NOT_CONNECTED', 'Not connected');","context":" 267:     it('returns 403 when not connected', async () => {\n 268:       const jwt = await createJwt('user-123');\n>269:       fakeUserService.setTokenError('NOT_CONNECTED', 'Not connected');\n 270: \n 271:       const response = await app.inject({"},{"type":"typecheck","code":"TS2345","file":"apps/calendar-agent/src/__tests__/calendarRoutes.test.ts","line":389,"message":"Argument of type '\"NOT_CONNECTED\"' is not assignable to parameter of type '\"NETWORK_ERROR\" | \"NO_API_KEY\" | \"INVALID_MODEL\" | \"API_ERROR\" | \"CONNECTION_NOT_FOUND\" | \"TOKEN_REFRESH_FAILED\" | \"OAUTH_NOT_CONFIGURED\"'.","snippet":"fakeUserService.setTokenError('NOT_CONNECTED', 'Not connected');","context":" 387:     it('returns 403 when not connected', async () => {\n 388:       const jwt = await createJwt('user-123');\n>389:       fakeUserService.setTokenError('NOT_CONNECTED', 'Not connected');\n 390: \n 391:       const response = await app.inject({"},{"type":"typecheck","code":"TS2345","file":"apps/calendar-agent/src/__tests__/calendarRoutes.test.ts","line":547,"message":"Argument of type '\"NOT_CONNECTED\"' is not assignable to parameter of type '\"NETWORK_ERROR\" | \"NO_API_KEY\" | \"INVALID_MODEL\" | \"API_ERROR\" | \"CONNECTION_NOT_FOUND\" | \"TOKEN_REFRESH_FAILED\" | \"OAUTH_NOT_CONFIGURED\"'.","snippet":"fakeUserService.setTokenError('NOT_CONNECTED', 'Not connected');","context":" 545:     it('returns 403 when not connected', async () => {\n 546:       const jwt = await createJwt('user-123');\n>547:       fakeUserService.setTokenError('NOT_CONNECTED', 'Not connected');\n 548: \n 549:       const response = await app.inject({"},{"type":"typecheck","code":"TS2345","file":"apps/calendar-agent/src/__tests__/calendarRoutes.test.ts","line":624,"message":"Argument of type '\"NOT_CONNECTED\"' is not assignable to parameter of type '\"NETWORK_ERROR\" | \"NO_API_KEY\" | \"INVALID_MODEL\" | \"API_ERROR\" | \"CONNECTION_NOT_FOUND\" | \"TOKEN_REFRESH_FAILED\" | \"OAUTH_NOT_CONFIGURED\"'.","snippet":"fakeUserService.setTokenError('NOT_CONNECTED', 'Not connected');","context":" 622:     it('returns 403 when not connected', async () => {\n 623:       const jwt = await createJwt('user-123');\n>624:       fakeUserService.setTokenError('NOT_CONNECTED', 'Not connected');\n 625: \n 626:       const response = await app.inject({"},{"type":"typecheck","code":"TS2345","file":"apps/calendar-agent/src/__tests__/calendarRoutes.test.ts","line":715,"message":"Argument of type '\"NOT_CONNECTED\"' is not assignable to parameter of type '\"NETWORK_ERROR\" | \"NO_API_KEY\" | \"INVALID_MODEL\" | \"API_ERROR\" | \"CONNECTION_NOT_FOUND\" | \"TOKEN_REFRESH_FAILED\" | \"OAUTH_NOT_CONFIGURED\"'.","snippet":"fakeUserService.setTokenError('NOT_CONNECTED', 'Not connected');","context":" 713:     it('returns 403 when not connected', async () => {\n 714:       const jwt = await createJwt('user-123');\n>715:       fakeUserService.setTokenError('NOT_CONNECTED', 'Not connected');\n 716: \n 717:       const response = await app.inject({"},{"type":"typecheck","code":"TS2345","file":"apps/calendar-agent/src/__tests__/domain/useCases/getFreeBusy.test.ts","line":147,"message":"Argument of type '\"NOT_CONNECTED\"' is not assignable to parameter of type '\"NETWORK_ERROR\" | \"NO_API_KEY\" | \"INVALID_MODEL\" | \"API_ERROR\" | \"CONNECTION_NOT_FOUND\" | \"TOKEN_REFRESH_FAILED\" | \"OAUTH_NOT_CONFIGURED\"'.","snippet":"userServiceClient.setTokenError('NOT_CONNECTED', 'Google Calendar not connected');","context":" 145:   describe('OAuth token errors', () => {\n 146:     it('returns error when user is not connected', async () => {\n>147:       userServiceClient.setTokenError('NOT_CONNECTED', 'Google Calendar not connected');\n 148: \n 149:       const result = await getFreeBusy("},{"type":"typecheck","code":"TS2345","file":"apps/calendar-agent/src/__tests__/domain/useCases/getFreeBusy.test.ts","line":180,"message":"Argument of type '\"TOKEN_ERROR\"' is not assignable to parameter of type '\"NETWORK_ERROR\" | \"NO_API_KEY\" | \"INVALID_MODEL\" | \"API_ERROR\" | \"CONNECTION_NOT_FOUND\" | \"TOKEN_REFRESH_FAILED\" | \"OAUTH_NOT_CONFIGURED\"'.","snippet":"userServiceClient.setTokenError('TOKEN_ERROR', 'Invalid token');","context":" 178: \n 179:     it('returns error when token fetch fails', async () => {\n>180:       userServiceClient.setTokenError('TOKEN_ERROR', 'Invalid token');\n 181: \n 182:       const result = await getFreeBusy("},{"type":"typecheck","code":"TS2345","file":"apps/calendar-agent/src/__tests__/domain/useCases/processCalendarAction.test.ts","line":362,"message":"Argument of type '\"NOT_CONNECTED\"' is not assignable to parameter of type '\"NETWORK_ERROR\" | \"NO_API_KEY\" | \"INVALID_MODEL\" | \"API_ERROR\" | \"CONNECTION_NOT_FOUND\" | \"TOKEN_REFRESH_FAILED\" | \"OAUTH_NOT_CONFIGURED\"'.","snippet":"userServiceClient.setTokenError('NOT_CONNECTED', 'Google Calendar not connected');","context":" 360:       });\n 361: \n>362:       userServiceClient.setTokenError('NOT_CONNECTED', 'Google Calendar not connected');\n 363: \n 364:       const result = await processCalendarAction("},{"type":"typecheck","code":"TS2345","file":"apps/calendar-agent/src/__tests__/domain/useCases/processCalendarAction.test.ts","line":400,"message":"Argument of type '\"TOKEN_ERROR\"' is not assignable to parameter of type '\"NETWORK_ERROR\" | \"NO_API_KEY\" | \"INVALID_MODEL\" | \"API_ERROR\" | \"CONNECTION_NOT_FOUND\" | \"TOKEN_REFRESH_FAILED\" | \"OAUTH_NOT_CONFIGURED\"'.","snippet":"userServiceClient.setTokenError('TOKEN_ERROR', 'Token expired');","context":" 398:       });\n 399: \n>400:       userServiceClient.setTokenError('TOKEN_ERROR', 'Token expired');\n 401: \n 402:       const result = await processCalendarAction("},{"type":"typecheck","code":"TS2307","file":"apps/commands-agent/src/__tests__/fakes.ts","line":16,"message":"Cannot find module '../domain/ports/userServiceClient.js' or its corresponding type declarations.","snippet":"import type { UserServiceClient, UserApiKeys, UserServiceError } from '../domain/ports/userServiceClient.js';","context":" 14: import type { EventPublisherPort, PublishError } from '../domain/ports/eventPublisher.js';\n 15: import type { ActionCreatedEvent } from '../domain/events/actionCreatedEvent.js';\n>16: import type { UserServiceClient, UserApiKeys, UserServiceError } from '../domain/ports/userServiceClient.js';\n 17: import type { ActionsAgentClient, CreateActionParams } from '../infra/actionsAgent/client.js';\n 18: import { createProcessCommandUseCase } from '../domain/usecases/processCommand.js';"},{"type":"typecheck","code":"TS2739","file":"apps/commands-agent/src/__tests__/fakes.ts","line":236,"message":"Type 'FakeUserServiceClient' is missing the following properties from type 'UserServiceClient': reportLlmSuccess, getOAuthToken","snippet":"userServiceClient: deps.userServiceClient,","context":" 234:     actionsAgentClient: deps.actionsAgentClient,\n 235:     classifierFactory,\n>236:     userServiceClient: deps.userServiceClient,\n 237:     eventPublisher: deps.eventPublisher,\n 238:     processCommandUseCase: createProcessCommandUseCase({"},{"type":"typecheck","code":"TS2739","file":"apps/commands-agent/src/__tests__/fakes.ts","line":242,"message":"Type 'FakeUserServiceClient' is missing the following properties from type 'UserServiceClient': reportLlmSuccess, getOAuthToken","snippet":"userServiceClient: deps.userServiceClient,","context":" 240:       actionsAgentClient: deps.actionsAgentClient,\n 241:       classifierFactory,\n>242:       userServiceClient: deps.userServiceClient,\n 243:       eventPublisher: deps.eventPublisher,\n 244:       logger,"},{"type":"typecheck","code":"TS2739","file":"apps/commands-agent/src/__tests__/fakes.ts","line":250,"message":"Type 'FakeUserServiceClient' is missing the following properties from type 'UserServiceClient': reportLlmSuccess, getOAuthToken","snippet":"userServiceClient: deps.userServiceClient,","context":" 248:       actionsAgentClient: deps.actionsAgentClient,\n 249:       classifierFactory,\n>250:       userServiceClient: deps.userServiceClient,\n 251:       eventPublisher: deps.eventPublisher,\n 252:       logger,"},{"type":"typecheck","code":"TS2307","file":"apps/commands-agent/src/__tests__/infra/userServiceClient.test.ts","line":7,"message":"Cannot find module '../../infra/user/index.js' or its corresponding type declarations.","snippet":"import { createUserServiceClient } from '../../infra/user/index.js';","context":" 5: import { createPricingContext } from '@intexuraos/llm-pricing';\n 6: import { LlmModels, LlmProviders } from '@intexuraos/llm-contract';\n>7: import { createUserServiceClient } from '../../infra/user/index.js';\n 8: \n 9: const INTEXURAOS_USER_SERVICE_URL = 'http://localhost:8081';"},{"type":"typecheck","code":"TS2739","file":"apps/commands-agent/src/__tests__/usecases/processCommand.test.ts","line":64,"message":"Type 'FakeUserServiceClient' is missing the following properties from type 'UserServiceClient': reportLlmSuccess, getOAuthToken","snippet":"userServiceClient,","context":" 62:         actionsAgentClient,\n 63:         classifierFactory: () => classifier,\n>64:         userServiceClient,\n 65:         eventPublisher,\n 66:         logger,"},{"type":"typecheck","code":"TS2739","file":"apps/commands-agent/src/__tests__/usecases/processCommand.test.ts","line":104,"message":"Type 'FakeUserServiceClient' is missing the following properties from type 'UserServiceClient': reportLlmSuccess, getOAuthToken","snippet":"userServiceClient,","context":" 102:         actionsAgentClient,\n 103:         classifierFactory: () => classifier,\n>104:         userServiceClient,\n 105:         eventPublisher,\n 106:         logger,"},{"type":"typecheck","code":"TS2739","file":"apps/commands-agent/src/__tests__/usecases/processCommand.test.ts","line":148,"message":"Type 'FakeUserServiceClient' is missing the following properties from type 'UserServiceClient': reportLlmSuccess, getOAuthToken","snippet":"userServiceClient,","context":" 146:         actionsAgentClient,\n 147:         classifierFactory: () => classifier,\n>148:         userServiceClient,\n 149:         eventPublisher,\n 150:         logger,"},{"type":"typecheck","code":"TS2739","file":"apps/commands-agent/src/__tests__/usecases/processCommand.test.ts","line":201,"message":"Type 'FakeUserServiceClient' is missing the following properties from type 'UserServiceClient': reportLlmSuccess, getOAuthToken","snippet":"userServiceClient,","context":" 199:         actionsAgentClient,\n 200:         classifierFactory: () => classifier,\n>201:         userServiceClient,\n 202:         eventPublisher,\n 203:         logger,"},{"type":"typecheck","code":"TS2739","file":"apps/commands-agent/src/__tests__/usecases/processCommand.test.ts","line":234,"message":"Type 'FakeUserServiceClient' is missing the following properties from type 'UserServiceClient': reportLlmSuccess, getOAuthToken","snippet":"userServiceClient,","context":" 232:         actionsAgentClient,\n 233:         classifierFactory: () => classifier,\n>234:         userServiceClient,\n 235:         eventPublisher,\n 236:         logger,"},{"type":"typecheck","code":"TS2739","file":"apps/commands-agent/src/__tests__/usecases/processCommand.test.ts","line":271,"message":"Type 'FakeUserServiceClient' is missing the following properties from type 'UserServiceClient': reportLlmSuccess, getOAuthToken","snippet":"userServiceClient,","context":" 269:         actionsAgentClient,\n 270:         classifierFactory: () => classifier,\n>271:         userServiceClient,\n 272:         eventPublisher,\n 273:         logger,"},{"type":"typecheck","code":"TS2739","file":"apps/commands-agent/src/__tests__/usecases/retryPendingCommands.test.ts","line":68,"message":"Type 'FakeUserServiceClient' is missing the following properties from type 'UserServiceClient': reportLlmSuccess, getOAuthToken","snippet":"userServiceClient,","context":" 66:       actionsAgentClient,\n 67:       classifierFactory: () => classifier,\n>68:       userServiceClient,\n 69:       eventPublisher,\n 70:       logger,"},{"type":"typecheck","code":"TS2739","file":"apps/commands-agent/src/__tests__/usecases/retryPendingCommands.test.ts","line":91,"message":"Type 'FakeUserServiceClient' is missing the following properties from type 'UserServiceClient': reportLlmSuccess, getOAuthToken","snippet":"userServiceClient,","context":" 89:       actionsAgentClient,\n 90:       classifierFactory: () => classifier,\n>91:       userServiceClient,\n 92:       eventPublisher,\n 93:       logger,"},{"type":"typecheck","code":"TS2739","file":"apps/commands-agent/src/__tests__/usecases/retryPendingCommands.test.ts","line":113,"message":"Type 'FakeUserServiceClient' is missing the following properties from type 'UserServiceClient': reportLlmSuccess, getOAuthToken","snippet":"userServiceClient,","context":" 111:       actionsAgentClient,\n 112:       classifierFactory: () => classifier,\n>113:       userServiceClient,\n 114:       eventPublisher,\n 115:       logger,"},{"type":"typecheck","code":"TS2739","file":"apps/commands-agent/src/__tests__/usecases/retryPendingCommands.test.ts","line":140,"message":"Type 'FakeUserServiceClient' is missing the following properties from type 'UserServiceClient': reportLlmSuccess, getOAuthToken","snippet":"userServiceClient,","context":" 138:       actionsAgentClient,\n 139:       classifierFactory: () => classifier,\n>140:       userServiceClient,\n 141:       eventPublisher,\n 142:       logger,"},{"type":"typecheck","code":"TS2739","file":"apps/commands-agent/src/__tests__/usecases/retryPendingCommands.test.ts","line":171,"message":"Type 'FakeUserServiceClient' is missing the following properties from type 'UserServiceClient': reportLlmSuccess, getOAuthToken","snippet":"userServiceClient,","context":" 169:       actionsAgentClient,\n 170:       classifierFactory: () => classifier,\n>171:       userServiceClient,\n 172:       eventPublisher,\n 173:       logger,"},{"type":"typecheck","code":"TS2739","file":"apps/commands-agent/src/__tests__/usecases/retryPendingCommands.test.ts","line":197,"message":"Type 'FakeUserServiceClient' is missing the following properties from type 'UserServiceClient': reportLlmSuccess, getOAuthToken","snippet":"userServiceClient,","context":" 195:       actionsAgentClient,\n 196:       classifierFactory: () => classifier,\n>197:       userServiceClient,\n 198:       eventPublisher,\n 199:       logger,"},{"type":"typecheck","code":"TS2739","file":"apps/commands-agent/src/__tests__/usecases/retryPendingCommands.test.ts","line":226,"message":"Type 'FakeUserServiceClient' is missing the following properties from type 'UserServiceClient': reportLlmSuccess, getOAuthToken","snippet":"userServiceClient,","context":" 224:       actionsAgentClient,\n 225:       classifierFactory: () => classifier,\n>226:       userServiceClient,\n 227:       eventPublisher,\n 228:       logger,"},{"type":"typecheck","code":"TS2739","file":"apps/commands-agent/src/__tests__/usecases/retryPendingCommands.test.ts","line":261,"message":"Type 'FakeUserServiceClient' is missing the following properties from type 'UserServiceClient': reportLlmSuccess, getOAuthToken","snippet":"userServiceClient,","context":" 259:       actionsAgentClient,\n 260:       classifierFactory: () => classifier,\n>261:       userServiceClient,\n 262:       eventPublisher,\n 263:       logger,"},{"type":"typecheck","code":"TS2741","file":"apps/data-insights-agent/src/__tests__/chartDefinitionService.test.ts","line":15,"message":"Property 'getOAuthToken' is missing in type '{ getLlmClient: Mock<Procedure>; getApiKeys: Mock<Procedure>; reportLlmSuccess: Mock<Procedure>; }' but required in type 'UserServiceClient'.","snippet":"return {","context":" 13:   ): UserServiceClient {\n 14:     if (!hasClient) {\n>15:       return {\n 16:         getLlmClient: vi\n 17:           .fn()"},{"type":"typecheck","code":"TS2741","file":"apps/data-insights-agent/src/__tests__/chartDefinitionService.test.ts","line":28,"message":"Property 'getOAuthToken' is missing in type '{ getLlmClient: Mock<Procedure>; getApiKeys: Mock<Procedure>; reportLlmSuccess: Mock<Procedure>; }' but required in type 'UserServiceClient'.","snippet":"return {","context":" 26:       generate: mockGenerate,\n 27:     };\n>28:     return {\n 29:       getLlmClient: vi.fn().mockResolvedValue(ok(mockLlmClient)),\n 30:       getApiKeys: vi.fn(),"},{"type":"typecheck","code":"TS2741","file":"apps/data-insights-agent/src/__tests__/dataAnalysisService.test.ts","line":19,"message":"Property 'getOAuthToken' is missing in type '{ getLlmClient: Mock<Procedure>; getApiKeys: Mock<Procedure>; reportLlmSuccess: Mock<Procedure>; }' but required in type 'UserServiceClient'.","snippet":"return {","context":" 17:   ): UserServiceClient {\n 18:     if (!hasClient) {\n>19:       return {\n 20:         getLlmClient: vi\n 21:           .fn()"},{"type":"typecheck","code":"TS2741","file":"apps/data-insights-agent/src/__tests__/dataAnalysisService.test.ts","line":32,"message":"Property 'getOAuthToken' is missing in type '{ getLlmClient: Mock<Procedure>; getApiKeys: Mock<Procedure>; reportLlmSuccess: Mock<Procedure>; }' but required in type 'UserServiceClient'.","snippet":"return {","context":" 30:       generate: mockGenerate,\n 31:     };\n>32:     return {\n 33:       getLlmClient: vi.fn().mockResolvedValue(ok(mockLlmClient)),\n 34:       getApiKeys: vi.fn(),"},{"type":"typecheck","code":"TS2741","file":"apps/data-insights-agent/src/__tests__/dataTransformService.test.ts","line":15,"message":"Property 'getOAuthToken' is missing in type '{ getLlmClient: Mock<Procedure>; getApiKeys: Mock<Procedure>; reportLlmSuccess: Mock<Procedure>; }' but required in type 'UserServiceClient'.","snippet":"return {","context":" 13:   ): UserServiceClient {\n 14:     if (!hasClient) {\n>15:       return {\n 16:         getLlmClient: vi\n 17:           .fn()"},{"type":"typecheck","code":"TS2741","file":"apps/data-insights-agent/src/__tests__/dataTransformService.test.ts","line":28,"message":"Property 'getOAuthToken' is missing in type '{ getLlmClient: Mock<Procedure>; getApiKeys: Mock<Procedure>; reportLlmSuccess: Mock<Procedure>; }' but required in type 'UserServiceClient'.","snippet":"return {","context":" 26:       generate: mockGenerate,\n 27:     };\n>28:     return {\n 29:       getLlmClient: vi.fn().mockResolvedValue(ok(mockLlmClient)),\n 30:       getApiKeys: vi.fn(),"},{"type":"typecheck","code":"TS2741","file":"apps/data-insights-agent/src/__tests__/feedNameGenerationService.test.ts","line":33,"message":"Property 'getOAuthToken' is missing in type '{ getLlmClient: Mock<Procedure>; getApiKeys: Mock<Procedure>; reportLlmSuccess: Mock<Procedure>; }' but required in type 'UserServiceClient'.","snippet":"mockUserServiceClient = {","context":" 31:       generate: mockGenerate,\n 32:     };\n>33:     mockUserServiceClient = {\n 34:       getLlmClient: vi.fn().mockResolvedValue(ok(mockLlmClient)),\n 35:         getApiKeys: vi.fn(),"},{"type":"typecheck","code":"TS2741","file":"apps/data-insights-agent/src/__tests__/titleGenerationService.test.ts","line":15,"message":"Property 'getOAuthToken' is missing in type '{ getLlmClient: Mock<Procedure>; getApiKeys: Mock<Procedure>; reportLlmSuccess: Mock<Procedure>; }' but required in type 'UserServiceClient'.","snippet":"return {","context":" 13:   ): UserServiceClient {\n 14:     if (!hasClient) {\n>15:       return {\n 16:         getLlmClient: vi\n 17:           .fn()"},{"type":"typecheck","code":"TS2741","file":"apps/data-insights-agent/src/__tests__/titleGenerationService.test.ts","line":28,"message":"Property 'getOAuthToken' is missing in type '{ getLlmClient: Mock<Procedure>; getApiKeys: Mock<Procedure>; reportLlmSuccess: Mock<Procedure>; }' but required in type 'UserServiceClient'.","snippet":"return {","context":" 26:       generate: mockGenerate,\n 27:     };\n>28:     return {\n 29:       getLlmClient: vi.fn().mockResolvedValue(ok(mockLlmClient)),\n 30:       getApiKeys: vi.fn(),"},{"type":"typecheck","code":"TS2307","file":"apps/image-service/src/__tests__/fakes.ts","line":17,"message":"Cannot find module '../infra/user/index.js' or its corresponding type declarations.","snippet":"import type { UserServiceClient, DecryptedApiKeys, UserServiceError } from '../infra/user/index.js';","context":" 15:   ThumbnailPrompt,\n 16: } from '../domain/index.js';\n>17: import type { UserServiceClient, DecryptedApiKeys, UserServiceError } from '../infra/user/index.js';\n 18: import type { LlmGenerateClient } from '@intexuraos/llm-factory';\n 19: "},{"type":"typecheck","code":"TS2741","file":"apps/image-service/src/__tests__/internalRoutes.test.ts","line":38,"message":"Property 'getOAuthToken' is missing in type 'FakeUserServiceClient' but required in type 'UserServiceClient'.","snippet":"userServiceClient: fakeUserClient,","context":" 36:       generatedImageRepository: fakeRepo,\n 37:       imageStorage: fakeStorage,\n>38:       userServiceClient: fakeUserClient,\n 39:       pricingContext: new FakePricingContext(),\n 40:       createPromptGenerator: () => fakePromptGenerator,"},{"type":"typecheck","code":"TS2741","file":"apps/image-service/src/__tests__/services.test.ts","line":57,"message":"Property 'getOAuthToken' is missing in type 'FakeUserServiceClient' but required in type 'UserServiceClient'.","snippet":"userServiceClient: fakeUserServiceClient,","context":" 55:         generatedImageRepository: fakeRepo,\n 56:         imageStorage: fakeImageStorage,\n>57:         userServiceClient: fakeUserServiceClient,\n 58:         pricingContext: fakePricingContext,\n 59:         createPromptGenerator: () => fakePromptGenerator,"},{"type":"typecheck","code":"TS2307","file":"apps/linear-agent/src/__tests__/infra/linearActionExtractionService.test.ts","line":11,"message":"Cannot find module '../../infra/user/llmUserServiceClient.js' or its corresponding type declarations.","snippet":"} from '../../infra/user/llmUserServiceClient.js';","context":" 9:   LlmUserServiceClient,\n 10:   LlmUserServiceError,\n>11: } from '../../infra/user/llmUserServiceClient.js';\n 12: import {\n 13:   createLinearActionExtractionService,"},{"type":"typecheck","code":"TS2345","file":"apps/linear-agent/src/__tests__/infra/linearActionExtractionService.test.ts","line":27,"message":"Argument of type 'FakeLlmUserServiceClient' is not assignable to parameter of type 'UserServiceClient'.","snippet":"service = createLinearActionExtractionService(fakeLlmUserService, silentLogger);","context":" 25:   beforeEach(() => {\n 26:     fakeLlmUserService = new FakeLlmUserServiceClient();\n>27:     service = createLinearActionExtractionService(fakeLlmUserService, silentLogger);\n 28:   });\n 29: "},{"type":"typecheck","code":"TS2307","file":"apps/linear-agent/src/__tests__/infra/user/llmUserServiceClient.test.ts","line":13,"message":"Cannot find module '../../../infra/user/llmUserServiceClient.js' or its corresponding type declarations.","snippet":"} from '../../../infra/user/llmUserServiceClient.js';","context":" 11:   createLlmUserServiceClient,\n 12:   type LlmUserServiceConfig,\n>13: } from '../../../infra/user/llmUserServiceClient.js';\n 14: \n 15: const silentLogger = pino({ level: 'silent' });"},{"type":"typecheck","code":"TS2307","file":"apps/research-agent/src/__tests__/fakes.ts","line":42,"message":"Cannot find module '../infra/user/index.js' or its corresponding type declarations.","snippet":"import type { DecryptedApiKeys, UserServiceClient, UserServiceError } from '../infra/user/index.js';","context":" 40:   ImprovementResult,\n 41: } from '../infra/llm/InputValidationAdapter.js';\n>42: import type { DecryptedApiKeys, UserServiceClient, UserServiceError } from '../infra/user/index.js';\n 43: import type { LlmGenerateClient, GenerateResult, LLMError } from '@intexuraos/llm-factory';\n 44: import type { ResearchEventPublisher, ResearchProcessEvent } from '../infra/pubsub/index.js';"},{"type":"typecheck","code":"TS2307","file":"apps/research-agent/src/__tests__/infra/userServiceClient.test.ts","line":8,"message":"Cannot find module '../../infra/user/index.js' or its corresponding type declarations.","snippet":"import { createUserServiceClient, type UserServiceConfig } from '../../infra/user/index.js';","context":" 6: import nock from 'nock';\n 7: import { FakePricingContext } from '@intexuraos/llm-pricing';\n>8: import { createUserServiceClient, type UserServiceConfig } from '../../infra/user/index.js';\n 9: \n 10: const INTEXURAOS_USER_SERVICE_URL = 'http://localhost:8081';"},{"type":"typecheck","code":"TS2741","file":"apps/research-agent/src/__tests__/routes.test.ts","line":90,"message":"Property 'getOAuthToken' is missing in type 'FakeUserServiceClient' but required in type 'UserServiceClient'.","snippet":"userServiceClient: fakeUserServiceClient,","context":" 88:       researchEventPublisher: fakeResearchEventPublisher,\n 89:       llmCallPublisher: fakeLlmCallPublisher,\n>90:       userServiceClient: fakeUserServiceClient,\n 91:       imageServiceClient: null,\n 92:       notificationSender: fakeNotificationSender,"},{"type":"typecheck","code":"TS2741","file":"apps/research-agent/src/__tests__/routes.test.ts","line":342,"message":"Property 'getOAuthToken' is missing in type 'FakeUserServiceClient' but required in type 'UserServiceClient'.","snippet":"userServiceClient: fakeUserServiceClient,","context":" 340:       researchEventPublisher: fakeResearchEventPublisher,\n 341:       llmCallPublisher: fakeLlmCallPublisher,\n>342:       userServiceClient: fakeUserServiceClient,\n 343:       imageServiceClient: null,\n 344:       notificationSender: fakeNotificationSender,"},{"type":"typecheck","code":"TS2741","file":"apps/research-agent/src/__tests__/routes.test.ts","line":2027,"message":"Property 'getOAuthToken' is missing in type 'FakeUserServiceClient' but required in type 'UserServiceClient'.","snippet":"userServiceClient: newFakeUserServiceClient,","context":" 2025:         researchEventPublisher: newFakeResearchEventPublisher,\n 2026:         llmCallPublisher: newFakeLlmCallPublisher,\n>2027:         userServiceClient: newFakeUserServiceClient,\n 2028:         imageServiceClient: null,\n 2029:         notificationSender: newFakeNotificationSender,"},{"type":"typecheck","code":"TS2741","file":"apps/research-agent/src/__tests__/routes.test.ts","line":2295,"message":"Property 'getOAuthToken' is missing in type 'FakeUserServiceClient' but required in type 'UserServiceClient'.","snippet":"userServiceClient: fakeUserServiceClient,","context":" 2293:         generateId: () => 'new-id-123',\n 2294:         researchEventPublisher: new FakeResearchEventPublisher(),\n>2295:         userServiceClient: fakeUserServiceClient,\n 2296:         imageServiceClient: null,\n 2297:         notificationSender: new FakeNotificationSender(),"},{"type":"typecheck","code":"TS2741","file":"apps/research-agent/src/__tests__/routes.test.ts","line":2428,"message":"Property 'getOAuthToken' is missing in type 'FakeUserServiceClient' but required in type 'UserServiceClient'.","snippet":"userServiceClient: fakeUserServiceClient,","context":" 2426:         researchEventPublisher: fakeResearchEventPublisher,\n 2427:         llmCallPublisher: new FakeLlmCallPublisher(),\n>2428:         userServiceClient: fakeUserServiceClient,\n 2429:         imageServiceClient: null,\n 2430:         notificationSender: fakeNotificationSender,"},{"type":"typecheck","code":"TS2741","file":"apps/research-agent/src/__tests__/routes.test.ts","line":2471,"message":"Property 'getOAuthToken' is missing in type 'FakeUserServiceClient' but required in type 'UserServiceClient'.","snippet":"userServiceClient: fakeUserServiceClient,","context":" 2469:           researchEventPublisher: fakeResearchEventPublisher,\n 2470:           llmCallPublisher: new FakeLlmCallPublisher(),\n>2471:           userServiceClient: fakeUserServiceClient,\n 2472:           imageServiceClient: null,\n 2473:           notificationSender: fakeNotificationSender,"},{"type":"typecheck","code":"TS2741","file":"apps/research-agent/src/__tests__/routes.test.ts","line":2513,"message":"Property 'getOAuthToken' is missing in type 'FakeUserServiceClient' but required in type 'UserServiceClient'.","snippet":"userServiceClient: fakeUserServiceClient,","context":" 2511:         researchEventPublisher: fakeResearchEventPublisher,\n 2512:         llmCallPublisher: new FakeLlmCallPublisher(),\n>2513:         userServiceClient: fakeUserServiceClient,\n 2514:         imageServiceClient: null,\n 2515:         notificationSender: fakeNotificationSender,"},{"type":"typecheck","code":"TS2741","file":"apps/research-agent/src/__tests__/routes.test.ts","line":2556,"message":"Property 'getOAuthToken' is missing in type 'FakeUserServiceClient' but required in type 'UserServiceClient'.","snippet":"userServiceClient: fakeUserServiceClient,","context":" 2554:           researchEventPublisher: fakeResearchEventPublisher,\n 2555:           llmCallPublisher: new FakeLlmCallPublisher(),\n>2556:           userServiceClient: fakeUserServiceClient,\n 2557:           imageServiceClient: null,\n 2558:           notificationSender: fakeNotificationSender,"},{"type":"typecheck","code":"TS2741","file":"apps/research-agent/src/__tests__/routes.test.ts","line":2599,"message":"Property 'getOAuthToken' is missing in type 'FakeUserServiceClient' but required in type 'UserServiceClient'.","snippet":"userServiceClient: fakeUserServiceClient,","context":" 2597:         researchEventPublisher: fakeResearchEventPublisher,\n 2598:         llmCallPublisher: new FakeLlmCallPublisher(),\n>2599:         userServiceClient: fakeUserServiceClient,\n 2600:         imageServiceClient: null,\n 2601:         notificationSender: fakeNotificationSender,"},{"type":"typecheck","code":"TS2741","file":"apps/research-agent/src/__tests__/routes.test.ts","line":2642,"message":"Property 'getOAuthToken' is missing in type 'FakeUserServiceClient' but required in type 'UserServiceClient'.","snippet":"userServiceClient: fakeUserServiceClient,","context":" 2640:           researchEventPublisher: fakeResearchEventPublisher,\n 2641:           llmCallPublisher: new FakeLlmCallPublisher(),\n>2642:           userServiceClient: fakeUserServiceClient,\n 2643:           imageServiceClient: null,\n 2644:           notificationSender: fakeNotificationSender,"},{"type":"typecheck","code":"TS2741","file":"apps/research-agent/src/__tests__/routes.test.ts","line":2684,"message":"Property 'getOAuthToken' is missing in type 'FakeUserServiceClient' but required in type 'UserServiceClient'.","snippet":"userServiceClient: fakeUserServiceClient,","context":" 2682:         researchEventPublisher: fakeResearchEventPublisher,\n 2683:         llmCallPublisher: new FakeLlmCallPublisher(),\n>2684:         userServiceClient: fakeUserServiceClient,\n 2685:         imageServiceClient: null,\n 2686:         notificationSender: fakeNotificationSender,"},{"type":"typecheck","code":"TS2741","file":"apps/research-agent/src/__tests__/routes.test.ts","line":2725,"message":"Property 'getOAuthToken' is missing in type 'FakeUserServiceClient' but required in type 'UserServiceClient'.","snippet":"userServiceClient: fakeUserServiceClient,","context":" 2723:           researchEventPublisher: fakeResearchEventPublisher,\n 2724:           llmCallPublisher: new FakeLlmCallPublisher(),\n>2725:           userServiceClient: fakeUserServiceClient,\n 2726:           imageServiceClient: null,\n 2727:           notificationSender: fakeNotificationSender,"},{"type":"typecheck","code":"TS2741","file":"apps/research-agent/src/__tests__/routes.test.ts","line":2844,"message":"Property 'getOAuthToken' is missing in type 'FakeUserServiceClient' but required in type 'UserServiceClient'.","snippet":"userServiceClient: fakeUserServiceClient,","context":" 2842:         researchEventPublisher: fakeResearchEventPublisher,\n 2843:         llmCallPublisher: new FakeLlmCallPublisher(),\n>2844:         userServiceClient: fakeUserServiceClient,\n 2845:         imageServiceClient: null,\n 2846:         notificationSender: fakeNotificationSender,"},{"type":"typecheck","code":"TS2741","file":"apps/research-agent/src/__tests__/routes.test.ts","line":2884,"message":"Property 'getOAuthToken' is missing in type 'FakeUserServiceClient' but required in type 'UserServiceClient'.","snippet":"userServiceClient: fakeUserServiceClient,","context":" 2882:           researchEventPublisher: fakeResearchEventPublisher,\n 2883:           llmCallPublisher: new FakeLlmCallPublisher(),\n>2884:           userServiceClient: fakeUserServiceClient,\n 2885:           imageServiceClient: null,\n 2886:           notificationSender: fakeNotificationSender,"},{"type":"typecheck","code":"TS2741","file":"apps/research-agent/src/__tests__/routes.test.ts","line":3110,"message":"Property 'getOAuthToken' is missing in type 'FakeUserServiceClient' but required in type 'UserServiceClient'.","snippet":"userServiceClient: fakeUserServiceClient,","context":" 3108:       researchEventPublisher: fakeResearchEventPublisher,\n 3109:       llmCallPublisher: fakeLlmCallPublisher,\n>3110:       userServiceClient: fakeUserServiceClient,\n 3111:       imageServiceClient: null,\n 3112:       notificationSender: fakeNotificationSender,"},{"type":"typecheck","code":"TS2741","file":"apps/research-agent/src/__tests__/routes.test.ts","line":3176,"message":"Property 'getOAuthToken' is missing in type 'FakeUserServiceClient' but required in type 'UserServiceClient'.","snippet":"userServiceClient: fakeUserServiceClient,","context":" 3174:       researchEventPublisher: fakeResearchEventPublisher,\n 3175:       llmCallPublisher: fakeLlmCallPublisher,\n>3176:       userServiceClient: fakeUserServiceClient,\n 3177:       imageServiceClient: null,\n 3178:       notificationSender: fakeNotificationSender,"},{"type":"typecheck","code":"TS2741","file":"apps/research-agent/src/__tests__/routes.test.ts","line":3624,"message":"Property 'getOAuthToken' is missing in type 'FakeUserServiceClient' but required in type 'UserServiceClient'.","snippet":"userServiceClient: fakeUserServiceClient,","context":" 3622:         researchEventPublisher: new FakeResearchEventPublisher(),\n 3623:         llmCallPublisher: fakeLlmCallPublisher,\n>3624:         userServiceClient: fakeUserServiceClient,\n 3625:         imageServiceClient: null,\n 3626:         notificationSender: fakeNotificationSender,"},{"type":"typecheck","code":"TS2741","file":"apps/research-agent/src/__tests__/routes.test.ts","line":4183,"message":"Property 'getOAuthToken' is missing in type 'FakeUserServiceClient' but required in type 'UserServiceClient'.","snippet":"userServiceClient: fakeUserServiceClient,","context":" 4181:         researchEventPublisher: new FakeResearchEventPublisher(),\n 4182:         llmCallPublisher: new FakeLlmCallPublisher(),\n>4183:         userServiceClient: fakeUserServiceClient,\n 4184:         imageServiceClient: null,\n 4185:         notificationSender: fakeNotificationSender,"},{"type":"typecheck","code":"TS2741","file":"apps/research-agent/src/__tests__/routes.test.ts","line":4277,"message":"Property 'getOAuthToken' is missing in type 'FakeUserServiceClient' but required in type 'UserServiceClient'.","snippet":"userServiceClient: fakeUserServiceClient,","context":" 4275:         researchEventPublisher: new FakeResearchEventPublisher(),\n 4276:         llmCallPublisher: new FakeLlmCallPublisher(),\n>4277:         userServiceClient: fakeUserServiceClient,\n 4278:         imageServiceClient: null,\n 4279:         notificationSender: new FakeNotificationSender(),"},{"type":"typecheck","code":"TS2741","file":"apps/research-agent/src/__tests__/routes.test.ts","line":4339,"message":"Property 'getOAuthToken' is missing in type 'FakeUserServiceClient' but required in type 'UserServiceClient'.","snippet":"userServiceClient: fakeUserServiceClient,","context":" 4337:         researchEventPublisher: new FakeResearchEventPublisher(),\n 4338:         llmCallPublisher: fakeLlmCallPublisher,\n>4339:         userServiceClient: fakeUserServiceClient,\n 4340:         imageServiceClient: null,\n 4341:         notificationSender: new FakeNotificationSender(),"},{"type":"typecheck","code":"TS2741","file":"apps/research-agent/src/__tests__/routes.test.ts","line":4426,"message":"Property 'getOAuthToken' is missing in type 'FakeUserServiceClient' but required in type 'UserServiceClient'.","snippet":"userServiceClient: fakeUserServiceClient,","context":" 4424:         researchEventPublisher: new FakeResearchEventPublisher(),\n 4425:         llmCallPublisher: fakeLlmCallPublisher,\n>4426:         userServiceClient: fakeUserServiceClient,\n 4427:         imageServiceClient: null,\n 4428:         notificationSender: fakeNotificationSender,"},{"type":"typecheck","code":"TS2741","file":"apps/research-agent/src/__tests__/routes.test.ts","line":4526,"message":"Property 'getOAuthToken' is missing in type 'FakeUserServiceClient' but required in type 'UserServiceClient'.","snippet":"userServiceClient: fakeUserServiceClient,","context":" 4524:         researchEventPublisher: new FakeResearchEventPublisher(),\n 4525:         llmCallPublisher: fakeLlmCallPublisher,\n>4526:         userServiceClient: fakeUserServiceClient,\n 4527:         imageServiceClient: null,\n 4528:         notificationSender: fakeNotificationSender,"},{"type":"typecheck","code":"TS2741","file":"apps/research-agent/src/__tests__/routes.test.ts","line":4602,"message":"Property 'getOAuthToken' is missing in type 'FakeUserServiceClient' but required in type 'UserServiceClient'.","snippet":"userServiceClient: fakeUserServiceClient,","context":" 4600:         researchEventPublisher: new FakeResearchEventPublisher(),\n 4601:         llmCallPublisher: new FakeLlmCallPublisher(),\n>4602:         userServiceClient: fakeUserServiceClient,\n 4603:         imageServiceClient: null,\n 4604:         notificationSender: fakeNotificationSender,"},{"type":"typecheck","code":"TS2741","file":"apps/research-agent/src/__tests__/routes.test.ts","line":4747,"message":"Property 'getOAuthToken' is missing in type 'FakeUserServiceClient' but required in type 'UserServiceClient'.","snippet":"userServiceClient: fakeUserServiceClient,","context":" 4745:       researchEventPublisher: fakeResearchEventPublisher,\n 4746:       llmCallPublisher: fakeLlmCallPublisher,\n>4747:       userServiceClient: fakeUserServiceClient,\n 4748:       imageServiceClient: null,\n 4749:       notificationSender: fakeNotificationSender,"},{"type":"typecheck","code":"TS2741","file":"apps/research-agent/src/__tests__/routes.test.ts","line":4869,"message":"Property 'getOAuthToken' is missing in type 'FakeUserServiceClient' but required in type 'UserServiceClient'.","snippet":"userServiceClient: fakeUserServiceClient,","context":" 4867:         researchEventPublisher: fakeResearchEventPublisher,\n 4868:         llmCallPublisher: fakeLlmCallPublisher,\n>4869:         userServiceClient: fakeUserServiceClient,\n 4870:         imageServiceClient: null,\n 4871:         notificationSender: fakeNotificationSender,"},{"type":"typecheck","code":"TS2741","file":"apps/research-agent/src/__tests__/routes.test.ts","line":4957,"message":"Property 'getOAuthToken' is missing in type 'FakeUserServiceClient' but required in type 'UserServiceClient'.","snippet":"userServiceClient: fakeUserServiceClient,","context":" 4955:         researchEventPublisher: fakeResearchEventPublisher,\n 4956:         llmCallPublisher: fakeLlmCallPublisher,\n>4957:         userServiceClient: fakeUserServiceClient,\n 4958:         imageServiceClient: null,\n 4959:         notificationSender: fakeNotificationSender,"},{"type":"typecheck","code":"TS2741","file":"apps/research-agent/src/__tests__/routes.test.ts","line":5301,"message":"Property 'getOAuthToken' is missing in type 'FakeUserServiceClient' but required in type 'UserServiceClient'.","snippet":"userServiceClient: fakeUserServiceClient,","context":" 5299:         researchEventPublisher: fakeResearchEventPublisher,\n 5300:         llmCallPublisher: fakeLlmCallPublisher,\n>5301:         userServiceClient: fakeUserServiceClient,\n 5302:         imageServiceClient: null,\n 5303:         notificationSender: fakeNotificationSender,"},{"type":"typecheck","code":"TS2741","file":"apps/research-agent/src/__tests__/routes.test.ts","line":5349,"message":"Property 'getOAuthToken' is missing in type 'FakeUserServiceClient' but required in type 'UserServiceClient'.","snippet":"userServiceClient: fakeUserServiceClient,","context":" 5347:         researchEventPublisher: fakeResearchEventPublisher,\n 5348:         llmCallPublisher: fakeLlmCallPublisher,\n>5349:         userServiceClient: fakeUserServiceClient,\n 5350:         imageServiceClient: null,\n 5351:         notificationSender: fakeNotificationSender,"},{"type":"typecheck","code":"TS2741","file":"apps/research-agent/src/__tests__/routes.test.ts","line":5453,"message":"Property 'getOAuthToken' is missing in type 'FakeUserServiceClient' but required in type 'UserServiceClient'.","snippet":"userServiceClient: fakeUserServiceClient,","context":" 5451:         researchEventPublisher: fakeResearchEventPublisher,\n 5452:         llmCallPublisher: fakeLlmCallPublisher,\n>5453:         userServiceClient: fakeUserServiceClient,\n 5454:         imageServiceClient: null,\n 5455:         notificationSender: fakeNotificationSender,"},{"type":"typecheck","code":"TS2307","file":"apps/research-agent/src/infra/llm/index.ts","line":17,"message":"Cannot find module '../user/index.js' or its corresponding type declarations.","snippet":"export type { DecryptedApiKeys } from '../user/index.js';","context":" 15: export { InputValidationAdapter } from './InputValidationAdapter.js';\n 16: // Re-export DecryptedApiKeys from user module (canonical source)\n>17: export type { DecryptedApiKeys } from '../user/index.js';\n 18: "},{"type":"typecheck","code":"TS2307","file":"apps/research-agent/src/routes/helpers/completionHandlers.ts","line":9,"message":"Cannot find module '../../infra/user/index.js' or its corresponding type declarations.","snippet":"import type { UserServiceClient } from '../../infra/user/index.js';","context":" 7: import type { ResearchRepository, NotificationSender } from '../../domain/research/ports/index.js';\n 8: import type { ServiceContainer, DecryptedApiKeys, ImageServiceClient } from '../../services.js';\n>9: import type { UserServiceClient } from '../../infra/user/index.js';\n 10: import type { ShareStoragePort } from '../../domain/research/ports/index.js';\n 11: import type { ShareConfig } from '../../services.js';"},{"type":"typecheck","code":"TS2420","file":"apps/todos-agent/src/__tests__/testUtils.ts","line":47,"message":"Class 'FakeUserServiceClient' incorrectly implements interface 'UserServiceClient'.","snippet":"export class FakeUserServiceClient implements UserServiceClient {","context":" 45: }\n 46: \n>47: export class FakeUserServiceClient implements UserServiceClient {\n 48:   public getLlmClientResult?: Result<LlmGenerateClient, { code: 'NETWORK_ERROR' | 'API_ERROR' | 'NO_API_KEY' | 'INVALID_MODEL'; message: string }>;\n 49: "},{"type":"typecheck","code":"TS2741","file":"apps/todos-agent/src/__tests__/testUtils.ts","line":171,"message":"Property 'getOAuthToken' is missing in type 'FakeUserServiceClient' but required in type 'UserServiceClient'.","snippet":"userServiceClient: context.userServiceClient,","context":" 169:       todoRepository: context.todoRepository,\n 170:       todosProcessingPublisher: context.todosProcessingPublisher,\n>171:       userServiceClient: context.userServiceClient,\n 172:       todoItemExtractionService: context.todoItemExtractionService,\n 173:     });"},{"type":"typecheck","code":"TS2741","file":"apps/todos-agent/src/__tests__/todoItemExtractionService.test.ts","line":52,"message":"Property 'getOAuthToken' is missing in type '{ getLlmClient: Mock<Procedure>; getApiKeys: Mock<Procedure>; reportLlmSuccess: Mock<Procedure>; }' but required in type 'UserServiceClient'.","snippet":"return {","context":" 50:     switch (result) {\n 51:       case 'ok':\n>52:         return {\n 53:           getLlmClient: vi.fn().mockResolvedValue(ok(mockLlmClient)),\n 54:           getApiKeys: vi.fn(),"},{"type":"typecheck","code":"TS2741","file":"apps/todos-agent/src/__tests__/todoItemExtractionService.test.ts","line":58,"message":"Property 'getOAuthToken' is missing in type '{ getLlmClient: Mock<Procedure>; getApiKeys: Mock<Procedure>; reportLlmSuccess: Mock<Procedure>; }' but required in type 'UserServiceClient'.","snippet":"return {","context":" 56:         };\n 57:       case 'no_api_key':\n>58:         return {\n 59:           getLlmClient: vi\n 60:             .fn()"},{"type":"typecheck","code":"TS2741","file":"apps/todos-agent/src/__tests__/todoItemExtractionService.test.ts","line":66,"message":"Property 'getOAuthToken' is missing in type '{ getLlmClient: Mock<Procedure>; getApiKeys: Mock<Procedure>; reportLlmSuccess: Mock<Procedure>; }' but required in type 'UserServiceClient'.","snippet":"return {","context":" 64:         };\n 65:       case 'api_error':\n>66:         return {\n 67:           getLlmClient: vi\n 68:             .fn()"},{"type":"typecheck","code":"TS2741","file":"apps/todos-agent/src/__tests__/todoItemExtractionService.test.ts","line":74,"message":"Property 'getOAuthToken' is missing in type '{ getLlmClient: Mock<Procedure>; getApiKeys: Mock<Procedure>; reportLlmSuccess: Mock<Procedure>; }' but required in type 'UserServiceClient'.","snippet":"return {","context":" 72:         };\n 73:       case 'network_error':\n>74:         return {\n 75:           getLlmClient: vi\n 76:             .fn()"},{"type":"typecheck","code":"TS2741","file":"apps/todos-agent/src/__tests__/todoItemExtractionService.test.ts","line":82,"message":"Property 'getOAuthToken' is missing in type '{ getLlmClient: Mock<Procedure>; getApiKeys: Mock<Procedure>; reportLlmSuccess: Mock<Procedure>; }' but required in type 'UserServiceClient'.","snippet":"return {","context":" 80:         };\n 81:       case 'invalid_model':\n>82:         return {\n 83:           getLlmClient: vi\n 84:             .fn()"},{"type":"typecheck","code":"TS2420","file":"apps/web-agent/src/__tests__/fakes.ts","line":154,"message":"Class 'FakeUserServiceClient' incorrectly implements interface 'UserServiceClient'.","snippet":"export class FakeUserServiceClient implements UserServiceClient {","context":" 152: }\n 153: \n>154: export class FakeUserServiceClient implements UserServiceClient {\n 155:   private llmClient: LlmGenerateClient = new FakeLlmGenerateClient();\n 156:   private shouldFail = false;"},{"type":"typecheck","code":"TS2741","file":"apps/web-agent/src/__tests__/internalRoutes.test.ts","line":95,"message":"Property 'getOAuthToken' is missing in type 'FakeUserServiceClient' but required in type 'UserServiceClient'.","snippet":"userServiceClient: fakeUserServiceClient,","context":" 93:       pageContentFetcher: fakePageContentFetcher,\n 94:       llmSummarizer: fakeLlmSummarizer,\n>95:       userServiceClient: fakeUserServiceClient,\n 96:     };\n 97: "},{"type":"typecheck","code":"TS2741","file":"apps/web-agent/src/__tests__/internalRoutes.test.ts","line":692,"message":"Property 'getOAuthToken' is missing in type 'FakeUserServiceClient' but required in type 'UserServiceClient'.","snippet":"userServiceClient: fakeUserService,","context":" 690:         pageContentFetcher: fakePageContentFetcher,\n 691:         llmSummarizer: createLlmSummarizer(fakeLogger as unknown as Logger),\n>692:         userServiceClient: fakeUserService,\n 693:       });\n 694: "},{"type":"typecheck","code":"TS2741","file":"apps/web-agent/src/__tests__/services.test.ts","line":77,"message":"Property 'getOAuthToken' is missing in type 'FakeUserServiceClient' but required in type 'UserServiceClient'.","snippet":"userServiceClient: fakeUserService,","context":" 75:         pageContentFetcher: fakeContentFetcher,\n 76:         llmSummarizer: fakeSummarizer,\n>77:         userServiceClient: fakeUserService,\n 78:       });\n 79: "},{"type":"verify","code":"VERIFY_FAIL","file":"unknown","line":0,"message":"FAILED","snippet":null,"context":null}]}
{"ts":"2026-01-25T23:19:41.573Z","project":"intexuraos-1","branch":"refactor/INT-301-consolidate-user-service-client","runNumber":3,"passed":false,"durationMs":14721,"failureCount":1,"failures":[{"type":"verify","code":"VERIFY_FAIL","file":"unknown","line":0,"message":"FAILED","snippet":null,"context":null}]}
{"ts":"2026-01-25T23:21:16.269Z","project":"intexuraos-1","branch":"refactor/INT-301-consolidate-user-service-client","runNumber":4,"passed":false,"durationMs":56404,"failureCount":2,"failures":[{"type":"typecheck","code":"TS2741","file":"apps/data-insights-agent/src/__tests__/feedNameGenerationService.test.ts","line":33,"message":"Property 'getOAuthToken' is missing in type '{ getLlmClient: Mock<Procedure>; getApiKeys: Mock<Procedure>; reportLlmSuccess: Mock<Procedure>; }' but required in type 'UserServiceClient'.","snippet":"mockUserServiceClient = {","context":" 31:       generate: mockGenerate,\n 32:     };\n>33:     mockUserServiceClient = {\n 34:       getLlmClient: vi.fn().mockResolvedValue(ok(mockLlmClient)),\n 35:         getApiKeys: vi.fn(),"},{"type":"verify","code":"VERIFY_FAIL","file":"unknown","line":0,"message":"FAILED","snippet":null,"context":null}]}
{"ts":"2026-01-25T23:23:50.772Z","project":"intexuraos-1","branch":"refactor/INT-301-consolidate-user-service-client","runNumber":5,"passed":false,"durationMs":136195,"failureCount":2,"failures":[{"type":"test","code":"TEST_FAIL","file":"apps/calendar-agent/src/__tests__/domain/useCases/getFreeBusy.test.ts","line":0,"message":"getFreeBusy > OAuth token errors > returns error when user is not connected","snippet":null,"context":null},{"type":"verify","code":"VERIFY_FAIL","file":"unknown","line":0,"message":"FAILED","snippet":null,"context":null}]}
{"ts":"2026-01-25T23:26:58.815Z","project":"intexuraos-1","branch":"refactor/INT-301-consolidate-user-service-client","runNumber":6,"passed":false,"durationMs":140575,"failureCount":2,"failures":[{"type":"test","code":"TEST_FAIL","file":"apps/calendar-agent/src/__tests__/domain/useCases/processCalendarAction.test.ts","line":0,"message":"processCalendarAction > when OAuth token retrieval fails > returns TOKEN_ERROR when token is invalid","snippet":null,"context":null},{"type":"verify","code":"VERIFY_FAIL","file":"unknown","line":0,"message":"FAILED","snippet":null,"context":null}]}
