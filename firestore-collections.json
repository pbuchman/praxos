{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "description": "Firestore Collection Ownership Registry - Each collection MUST be owned by exactly ONE service",
  "collections": {
    "_migrations": {
      "owner": "system",
      "description": "Database migration tracking - managed by scripts/migrate.mjs"
    },
    "notion_connections": {
      "owner": "notion-service",
      "description": "Notion OAuth connection tokens and state"
    },
    "promptvault_settings": {
      "owner": "promptvault-service",
      "description": "User's Notion Prompt Vault page ID configuration"
    },
    "whatsapp_messages": {
      "owner": "whatsapp-service",
      "description": "WhatsApp messages with transcription and link preview metadata"
    },
    "whatsapp_user_mappings": {
      "owner": "whatsapp-service",
      "description": "Phone number to user ID mappings for WhatsApp integration"
    },
    "whatsapp_webhook_events": {
      "owner": "whatsapp-service",
      "description": "Raw WhatsApp webhook events for audit and debugging"
    },
    "mobile_notifications": {
      "owner": "mobile-notifications-service",
      "description": "Mobile push notifications received from user devices"
    },
    "mobile_notification_signatures": {
      "owner": "mobile-notifications-service",
      "description": "Device signature to user ID bindings for notification delivery"
    },
    "mobile_notifications_filters": {
      "owner": "mobile-notifications-service",
      "description": "User filter options and saved filters for notifications"
    },
    "user_settings": {
      "owner": "user-service",
      "description": "User preferences and LLM API keys (encrypted)"
    },
    "auth_tokens": {
      "owner": "user-service",
      "description": "Auth0 refresh tokens (AES-256-GCM encrypted)"
    },
    "oauth_connections": {
      "owner": "user-service",
      "description": "Third-party OAuth tokens (Google, Microsoft) - AES-256-GCM encrypted"
    },
    "researches": {
      "owner": "research-agent",
      "description": "LLM research queries, responses, and synthesized results"
    },
    "llm_api_logs": {
      "owner": "research-agent",
      "description": "LLM API call audit logs with token usage and cost tracking"
    },
    "llm_usage_stats": {
      "owner": "llm-pricing",
      "description": "Aggregated LLM usage statistics by provider, model, and call type"
    },
    "commands": {
      "owner": "commands-agent",
      "description": "Incoming commands from various sources (WhatsApp, etc.) with classification metadata"
    },
    "actions": {
      "owner": "actions-agent",
      "description": "Action items and their execution lifecycle"
    },
    "actions_transitions": {
      "owner": "actions-agent",
      "description": "Logs of user corrections to action types for ML training"
    },
    "custom_data_sources": {
      "owner": "data-insights-agent",
      "description": "User-created custom data sources for analysis"
    },
    "composite_feeds": {
      "owner": "data-insights-agent",
      "description": "User-created composite feeds aggregating data sources and notifications"
    },
    "composite_feed_snapshots": {
      "owner": "data-insights-agent",
      "description": "Pre-computed snapshots of composite feed data for fast LLM retrieval"
    },
    "generated_images": {
      "owner": "image-service",
      "description": "Generated thumbnail images and their metadata"
    },
    "notes": {
      "owner": "notes-agent",
      "description": "User-scoped notes with tags and source tracking"
    },
    "settings": {
      "owner": "app-settings-service",
      "description": "Application settings including LLM pricing per provider"
    },
    "todos": {
      "owner": "todos-agent",
      "description": "User-scoped todos with items, priority, and due dates"
    },
    "bookmarks": {
      "owner": "bookmarks-agent",
      "description": "User-scoped bookmarks with OG metadata, AI summaries, and tags"
    },
    "visualizations": {
      "owner": "data-insights-agent",
      "description": "LLM-generated data visualizations with insights and Vega-Lite specs"
    }
  }
}
