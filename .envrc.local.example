# IntexuraOS Local Development Overrides
#
# Copy this file to .envrc.local and uncomment what you need.
# This file overrides values from .envrc (synced from Secret Manager).
#
# Usage:
#   cp .envrc.local.example .envrc.local
#   ./scripts/sync-secrets.sh
#   direnv allow
#   npm run dev

# =============================================================================
# AUTH (backend services require non-prefixed names)
# =============================================================================
# The fastifyAuthPlugin expects AUTH_* without INTEXURAOS_ prefix.
# Map from the prefixed versions loaded from Secret Manager.

export AUTH_JWKS_URL=$INTEXURAOS_AUTH_JWKS_URL
export AUTH_ISSUER=$INTEXURAOS_AUTH_ISSUER
export AUTH_AUDIENCE=$INTEXURAOS_AUTH_AUDIENCE

# =============================================================================
# EMULATORS
# =============================================================================
# Uncomment to use local emulators instead of GCP services.
# These are automatically set when using 'npm run dev', but you can
# also set them here if running services manually.

export FIRESTORE_EMULATOR_HOST=localhost:8101
export PUBSUB_EMULATOR_HOST=localhost:8102
export STORAGE_EMULATOR_HOST=http://localhost:8103

# =============================================================================
# SERVICE URLS (override run.app -> localhost)
# =============================================================================
# Override cloud-deployed services with locally running instances.
# Uncomment services you're running locally via 'npm run dev'.

export INTEXURAOS_USER_SERVICE_URL=http://localhost:8110
export INTEXURAOS_PROMPTVAULT_SERVICE_URL=http://localhost:8111
export INTEXURAOS_NOTION_SERVICE_URL=http://localhost:8112
export INTEXURAOS_WHATSAPP_SERVICE_URL=http://localhost:8113
export INTEXURAOS_MOBILE_NOTIFICATIONS_SERVICE_URL=http://localhost:8114
export INTEXURAOS_LLM_ORCHESTRATOR_URL=http://localhost:8116
export INTEXURAOS_COMMANDS_ROUTER_SERVICE_URL=http://localhost:8117
export INTEXURAOS_ACTIONS_AGENT_SERVICE_URL=http://localhost:8118
export INTEXURAOS_DATA_INSIGHTS_SERVICE_URL=http://localhost:8119
export INTEXURAOS_IMAGE_SERVICE_URL=http://localhost:8120
export INTEXURAOS_NOTES_AGENT_URL=http://localhost:8121
export INTEXURAOS_APP_SETTINGS_SERVICE_URL=http://localhost:8122
export INTEXURAOS_TODOS_AGENT_URL=http://localhost:8123
export INTEXURAOS_BOOKMARKS_AGENT_URL=http://localhost:8124
export INTEXURAOS_CALENDAR_AGENT_URL=http://localhost:8125

# =============================================================================
# GCS BUCKETS (for local fake-gcs-server)
# =============================================================================
# Required for media storage
export INTEXURAOS_WHATSAPP_MEDIA_BUCKET=intexuraos-whatsapp-media-local
export INTEXURAOS_IMAGE_BUCKET=intexuraos-images-local

# =============================================================================
# PUB/SUB (for local Firebase emulator)
# =============================================================================
# Required by whatsapp-service for media cleanup events
export INTEXURAOS_PUBSUB_MEDIA_CLEANUP_TOPIC=media-cleanup-local
export INTEXURAOS_PUBSUB_MEDIA_CLEANUP_SUBSCRIPTION=media-cleanup-sub-local

# Required for WhatsApp message sending via Pub/Sub
# llm-orchestrator publishes, whatsapp-service subscribes
export INTEXURAOS_PUBSUB_WHATSAPP_SEND_TOPIC=whatsapp-send-message
export INTEXURAOS_PUBSUB_WHATSAPP_SEND_SUBSCRIPTION=whatsapp-send-message-sub

# =============================================================================
# SERVICE-TO-SERVICE AUTHENTICATION
# =============================================================================
# Used for internal API calls and Pub/Sub push endpoint authentication
export INTEXURAOS_INTERNAL_AUTH_TOKEN=local-dev-token

# =============================================================================
# GCP PROJECT (for local emulators)
# =============================================================================
# Required by Google Cloud SDKs (Firestore, Pub/Sub, GCS).
# GOOGLE_CLOUD_PROJECT is the standard env var that Google SDKs look for.
# INTEXURAOS_GCP_PROJECT_ID is used by whatsapp-service.
export GOOGLE_CLOUD_PROJECT=demo-intexuraos
export GCLOUD_PROJECT=demo-intexuraos
export INTEXURAOS_GCP_PROJECT_ID=demo-intexuraos

# =============================================================================
# ENCRYPTION (for LLM API key storage)
# =============================================================================
# AES-256 encryption key for LLM API keys. Already set in .envrc from Secret Manager.
# Only override here if you need a different key for local testing.

# =============================================================================
# WEB APP (Auth0 SPA Configuration)
# =============================================================================
# Required for web app authentication. These values should match your
# Auth0 SPA application configuration.
#
# Note: These are automatically loaded from .envrc (Secret Manager) but
# you can override them here for local development if needed.

# export INTEXURAOS_AUTH0_DOMAIN=your-tenant.eu.auth0.com
# export INTEXURAOS_AUTH0_SPA_CLIENT_ID=your-spa-client-id
# export INTEXURAOS_AUTH_AUDIENCE=urn:intexuraos:api

# =============================================================================
# OPTIONAL: Custom ports
# =============================================================================
# Override default ports if needed (e.g., port conflict).
# Default ports: user=8110, promptvault=8111, notion=8112, whatsapp=8113,
# mobile-notifications=8114, api-docs-hub=8115, llm-orchestrator=8116,
# web=3000

# export USER_SERVICE_PORT=9110
# export PROMPTVAULT_SERVICE_PORT=9111

# =============================================================================
# PERSONAL IDENTIFIERS
# =============================================================================
# Used by Claude Code for sending WhatsApp messages and other personal actions
export INTEXURAOS_MY_PHONE_NUMBER=48534042325
export INTEXURAOS_USER_ID="google-oauth2|113131655542389277022"

# =============================================================================
# LOCAL WEB APP URL
# =============================================================================
# Used for redirect URIs in Auth0 SPA configuration during local development
export INTEXURAOS_WEB_APP_URL="http://localhost:3000"
