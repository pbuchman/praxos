services:
  firebase-emulator:
    image: andreysenov/firebase-tools
    ports:
      - '8100:8100'
      - '8101:8101'
      - '8102:8102'
    volumes:
      - ../firebase.json:/home/node/firebase.json:ro
    command: firebase emulators:start --project=demo-intexuraos
    healthcheck:
      test: ['CMD', 'curl', '-f', 'http://localhost:8100']
      interval: 5s
      timeout: 3s
      start_period: 30s
      retries: 10

  fake-gcs:
    image: fsouza/fake-gcs-server
    ports:
      - '8103:8103'
    command: -scheme http -port 8103 -external-url http://localhost:8103
    volumes:
      - gcs-data:/storage
    healthcheck:
      test: ['CMD', 'wget', '--spider', '-q', 'http://localhost:8103/storage/v1/b']
      interval: 5s
      timeout: 3s
      start_period: 10s
      retries: 5

volumes:
  gcs-data:
