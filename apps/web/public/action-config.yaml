# Action Configuration for IntexuraOS
# Defines reusable actions and their UI behavior for different action types.

actions:
  approve:
    endpoint:
      path: /actions/{actionId}/execute
      method: POST
      baseUrl: ${INTEXURAOS_ACTIONS_AGENT_URL}
    ui:
      label: Research!
      variant: success
      icon: CheckCircle
      confirmationMessage: 'This will create a research draft. Continue?'
    onSuccess:
      message: 'Research draft created!'
      linkLabel: 'View Draft →'

  approve_todo:
    endpoint:
      path: /actions/{actionId}/execute
      method: POST
      baseUrl: ${INTEXURAOS_ACTIONS_AGENT_URL}
    ui:
      label: Todo!
      variant: success
      icon: CheckCircle
      confirmationMessage: 'Create this todo?'
    onSuccess:
      message: 'Todo created!'
      linkLabel: 'View Todo →'

  approve_note:
    endpoint:
      path: /actions/{actionId}/execute
      method: POST
      baseUrl: ${INTEXURAOS_ACTIONS_AGENT_URL}
    ui:
      label: Note!
      variant: success
      icon: CheckCircle
      confirmationMessage: 'Create this note?'
    onSuccess:
      message: 'Note created!'
      linkLabel: 'View Note →'

  approve_link:
    endpoint:
      path: /actions/{actionId}/execute
      method: POST
      baseUrl: ${INTEXURAOS_ACTIONS_AGENT_URL}
    ui:
      label: Bookmark!
      variant: success
      icon: CheckCircle
      confirmationMessage: 'Save this link?'
    onSuccess:
      message: 'Link saved!'
      linkLabel: 'View Bookmark →'

  retry:
    endpoint:
      path: /actions/{actionId}/execute
      method: POST
      baseUrl: ${INTEXURAOS_ACTIONS_AGENT_URL}
    ui:
      label: Retry
      variant: primary
      icon: Play
      confirmationMessage: 'Retry creating research draft?'
    onSuccess:
      message: 'Research draft created!'
      linkLabel: 'View Draft →'

  retry_todo:
    endpoint:
      path: /actions/{actionId}/execute
      method: POST
      baseUrl: ${INTEXURAOS_ACTIONS_AGENT_URL}
    ui:
      label: Retry
      variant: primary
      icon: Play
      confirmationMessage: 'Retry creating todo?'
    onSuccess:
      message: 'Todo created!'
      linkLabel: 'View Todo →'

  retry_note:
    endpoint:
      path: /actions/{actionId}/execute
      method: POST
      baseUrl: ${INTEXURAOS_ACTIONS_AGENT_URL}
    ui:
      label: Retry
      variant: primary
      icon: Play
      confirmationMessage: 'Retry creating note?'
    onSuccess:
      message: 'Note created!'
      linkLabel: 'View Note →'

  retry_link:
    endpoint:
      path: /actions/{actionId}/resolve-duplicate
      method: POST
      baseUrl: ${INTEXURAOS_ACTIONS_AGENT_URL}
      body:
        action: update
    ui:
      label: Retry
      variant: primary
      icon: Play
      confirmationMessage: 'Update existing bookmark with fresh data?'
    onSuccess:
      message: 'Bookmark updated!'
      linkLabel: 'View Bookmark →'

  reject:
    endpoint:
      path: /actions/{actionId}
      method: PATCH
      baseUrl: ${INTEXURAOS_ACTIONS_AGENT_URL}
      body:
        status: rejected
    ui:
      label: Reject
      variant: secondary
      icon: XCircle

  archive:
    endpoint:
      path: /actions/{actionId}
      method: PATCH
      baseUrl: ${INTEXURAOS_ACTIONS_AGENT_URL}
      body:
        status: archived
    ui:
      label: Archive
      variant: secondary
      icon: Archive

  delete:
    endpoint:
      path: /actions/{actionId}
      method: DELETE
      baseUrl: ${INTEXURAOS_ACTIONS_AGENT_URL}
    ui:
      label: Delete
      variant: secondary
      icon: Trash2

types:
  research:
    actions:
      # Approve - only for awaiting_approval
      - action: approve
        when:
          field: status
          op: eq
          value: awaiting_approval

      # Retry - only for failed
      - action: retry
        when:
          field: status
          op: eq
          value: failed

      # Reject - only for awaiting_approval
      - action: reject
        when:
          field: status
          op: eq
          value: awaiting_approval

      # Archive - for completed, failed, rejected (NOT archived or awaiting_approval)
      - action: archive
        when:
          field: status
          op: in
          value: [completed, failed, rejected]

      # Delete - available for all statuses
      - action: delete

  todo:
    actions:
      - action: approve_todo
        when:
          field: status
          op: eq
          value: awaiting_approval

      - action: retry_todo
        when:
          field: status
          op: eq
          value: failed

      - action: reject
        when:
          field: status
          op: eq
          value: awaiting_approval

      - action: archive
        when:
          field: status
          op: in
          value: [completed, failed, rejected]

      - action: delete

  note:
    actions:
      - action: approve_note
        when:
          field: status
          op: eq
          value: awaiting_approval

      - action: retry_note
        when:
          field: status
          op: eq
          value: failed

      - action: reject
        when:
          field: status
          op: eq
          value: awaiting_approval

      - action: archive
        when:
          field: status
          op: in
          value: [completed, failed, rejected]

      - action: delete

  link:
    actions:
      - action: approve_link
        when:
          field: status
          op: eq
          value: awaiting_approval

      - action: retry_link
        when:
          field: status
          op: eq
          value: failed

      - action: reject
        when:
          field: status
          op: eq
          value: awaiting_approval

      - action: archive
        when:
          field: status
          op: in
          value: [completed, failed, rejected]

      - action: delete
